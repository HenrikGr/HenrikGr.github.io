<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.f0e6320b25128c443eb7.css" id="gatsby-global-css">code[class*=language-],pre[class*=language-]{text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;color:#eee;background:#272822;font-family:Roboto Mono,monospace;font-size:1em;line-height:1.5em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#363636}:not(pre)>code[class*=language-]{white-space:normal;border-radius:.2em;padding:.1em}pre[class*=language-]{overflow:auto;position:relative;margin:.5em 0;padding:1.25em 1em}.language-css>code,.language-sass>code,.language-scss>code{color:#fd9170}[class*=language-] .namespace{opacity:.7}.token.atrule{color:#c792ea}.token.attr-name{color:#ffcb6b}.token.attr-value,.token.attribute{color:#a5e844}.token.boolean{color:#c792ea}.token.builtin{color:#ffcb6b}.token.cdata,.token.char{color:#80cbc4}.token.class{color:#ffcb6b}.token.class-name{color:#f2ff00}.token.comment{color:#616161}.token.constant{color:#c792ea}.token.deleted{color:#f66}.token.doctype{color:#616161}.token.entity{color:#f66}.token.function{color:#c792ea}.token.hexcode{color:#f2ff00}.token.id,.token.important{color:#c792ea;font-weight:700}.token.inserted{color:#80cbc4}.token.keyword{color:#c792ea}.token.number{color:#fd9170}.token.operator{color:#89ddff}.token.prolog{color:#616161}.token.property{color:#80cbc4}.token.pseudo-class,.token.pseudo-element{color:#a5e844}.token.punctuation{color:#89ddff}.token.regex{color:#f2ff00}.token.selector{color:#f66}.token.string{color:#a5e844}.token.symbol{color:#c792ea}.token.tag{color:#f66}.token.unit{color:#fd9170}.token.url,.token.variable{color:#f66}pre[class*=language-].line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}pre[class*=language-].line-numbers>code{position:relative;white-space:inherit}.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:0;font-size:100%;left:-3.8em;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-ms-user-select:none;user-select:none}.line-numbers-rows>span{display:block;counter-increment:linenumber}.line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}h1{font-size:30px;line-height:1.167;letter-spacing:0}h1,h2{font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;margin-top:16px;margin-bottom:8px}h2{font-size:24px;line-height:1.235;letter-spacing:.00735em}h3{font-family:Roboto,Helvetica,Arial,sans-serif;font-size:18px;font-weight:500;line-height:1.334;letter-spacing:0;margin-top:16px;margin-bottom:8px}caption{font-size:.75rem;line-height:1.67;letter-spacing:.03333rem;margin:0}caption,p{font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400}p{line-height:1.43;letter-spacing:.01071em;margin-top:0;margin-bottom:16px}li,p{font-size:.875rem}li{font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.5;letter-spacing:.01786rem;margin:8px 0 0}blockquote{margin:0 0 16px;padding:16px;border-left:5px solid #d84315;background-color:#272822;color:#fff}blockquote>p{margin:0}a{color:#ff9800}.gatsby-highlight{background-color:#272822;border-radius:.4em;margin:1.6em 0;padding:1em;overflow:auto}.gatsby-highlight pre[class*=language-].line-numbers{padding:0 0 0 2.8em;overflow:initial}.gatsby-highlight-code-line{background-color:#000;display:block;margin-right:-1em;margin-left:-1em;padding-right:1em;padding-left:.75em;border-left:.25em solid #111}</style><meta name="generator" content="Gatsby 3.1.2"/><title data-react-helmet="true">Henrik Grönvall Consulting AB - Session management for web applications</title><link data-react-helmet="true" href="https://fonts.googleapis.com/css?family=Roboto:400,500,700&amp;display=swap" rel="stylesheet"/><meta data-react-helmet="true" name="description" content="A web session is a sequence of network HTTP request and response transactions associated with the same user. Modern and
complex web applications require the…"/><meta data-react-helmet="true" name="keywords" content="JavaScript,React,Node.js,HTML,CSS,Cloud"/><style id="jss-server-side">.jss4{padding-top:16px;padding-bottom:16px}.jss5{padding-top:16px;padding-left:16px;padding-right:16px;padding-bottom:16px}.jss6{padding-top:8px;padding-bottom:8px}.MuiTypography-root{margin:0}.MuiTypography-body2{font-size:.875rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.43;letter-spacing:.01071em}.MuiTypography-body1{font-size:1rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.5;letter-spacing:.00938em}.MuiTypography-caption{font-size:.75rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.66;letter-spacing:.03333em}.MuiTypography-button{font-size:.875rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:500;line-height:1.75;letter-spacing:.02857em;text-transform:uppercase}.MuiTypography-h1{font-size:6rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:300;line-height:1.167;letter-spacing:-.01562em}.MuiTypography-h2{font-size:3.75rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:300;line-height:1.2;letter-spacing:-.00833em}.MuiTypography-h3{font-size:3rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.167;letter-spacing:0}.MuiTypography-h4{font-size:2.125rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.235;letter-spacing:.00735em}.MuiTypography-h5{font-size:1.5rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.334;letter-spacing:0}.MuiTypography-h6{font-size:1.25rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:500;line-height:1.6;letter-spacing:.0075em}.MuiTypography-subtitle1{font-size:1rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.75;letter-spacing:.00938em}.MuiTypography-subtitle2{font-size:.875rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:500;line-height:1.57;letter-spacing:.00714em}.MuiTypography-overline{font-size:.75rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:2.66;letter-spacing:.08333em;text-transform:uppercase}.MuiTypography-srOnly{width:1px;height:1px;overflow:hidden;position:absolute}.MuiTypography-alignLeft{text-align:left}.MuiTypography-alignCenter{text-align:center}.MuiTypography-alignRight{text-align:right}.MuiTypography-alignJustify{text-align:justify}.MuiTypography-noWrap{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.MuiTypography-gutterBottom{margin-bottom:.35em}.MuiTypography-paragraph{margin-bottom:16px}.MuiTypography-colorInherit{color:inherit}.MuiTypography-colorPrimary{color:#3f51b5}.MuiTypography-colorSecondary{color:#f50057}.MuiTypography-colorTextPrimary{color:rgba(0,0,0,.87)}.MuiTypography-colorTextSecondary{color:rgba(0,0,0,.54)}.MuiTypography-colorError{color:#f44336}.MuiTypography-displayInline{display:inline}.MuiTypography-displayBlock{display:block}.MuiPaper-root{color:rgba(0,0,0,.87);transition:box-shadow .3s cubic-bezier(.4,0,.2,1) 0s;background-color:#fff}.MuiPaper-rounded{border-radius:4px}.MuiPaper-outlined{border:1px solid rgba(0,0,0,.12)}.MuiPaper-elevation0{box-shadow:none}.MuiPaper-elevation1{box-shadow:0 2px 1px -1px rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 1px 3px 0 rgba(0,0,0,.12)}.MuiPaper-elevation2{box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12)}.MuiPaper-elevation3{box-shadow:0 3px 3px -2px rgba(0,0,0,.2),0 3px 4px 0 rgba(0,0,0,.14),0 1px 8px 0 rgba(0,0,0,.12)}.MuiPaper-elevation4{box-shadow:0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12)}.MuiPaper-elevation5{box-shadow:0 3px 5px -1px rgba(0,0,0,.2),0 5px 8px 0 rgba(0,0,0,.14),0 1px 14px 0 rgba(0,0,0,.12)}.MuiPaper-elevation6{box-shadow:0 3px 5px -1px rgba(0,0,0,.2),0 6px 10px 0 rgba(0,0,0,.14),0 1px 18px 0 rgba(0,0,0,.12)}.MuiPaper-elevation7{box-shadow:0 4px 5px -2px rgba(0,0,0,.2),0 7px 10px 1px rgba(0,0,0,.14),0 2px 16px 1px rgba(0,0,0,.12)}.MuiPaper-elevation8{box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.MuiPaper-elevation9{box-shadow:0 5px 6px -3px rgba(0,0,0,.2),0 9px 12px 1px rgba(0,0,0,.14),0 3px 16px 2px rgba(0,0,0,.12)}.MuiPaper-elevation10{box-shadow:0 6px 6px -3px rgba(0,0,0,.2),0 10px 14px 1px rgba(0,0,0,.14),0 4px 18px 3px rgba(0,0,0,.12)}.MuiPaper-elevation11{box-shadow:0 6px 7px -4px rgba(0,0,0,.2),0 11px 15px 1px rgba(0,0,0,.14),0 4px 20px 3px rgba(0,0,0,.12)}.MuiPaper-elevation12{box-shadow:0 7px 8px -4px rgba(0,0,0,.2),0 12px 17px 2px rgba(0,0,0,.14),0 5px 22px 4px rgba(0,0,0,.12)}.MuiPaper-elevation13{box-shadow:0 7px 8px -4px rgba(0,0,0,.2),0 13px 19px 2px rgba(0,0,0,.14),0 5px 24px 4px rgba(0,0,0,.12)}.MuiPaper-elevation14{box-shadow:0 7px 9px -4px rgba(0,0,0,.2),0 14px 21px 2px rgba(0,0,0,.14),0 5px 26px 4px rgba(0,0,0,.12)}.MuiPaper-elevation15{box-shadow:0 8px 9px -5px rgba(0,0,0,.2),0 15px 22px 2px rgba(0,0,0,.14),0 6px 28px 5px rgba(0,0,0,.12)}.MuiPaper-elevation16{box-shadow:0 8px 10px -5px rgba(0,0,0,.2),0 16px 24px 2px rgba(0,0,0,.14),0 6px 30px 5px rgba(0,0,0,.12)}.MuiPaper-elevation17{box-shadow:0 8px 11px -5px rgba(0,0,0,.2),0 17px 26px 2px rgba(0,0,0,.14),0 6px 32px 5px rgba(0,0,0,.12)}.MuiPaper-elevation18{box-shadow:0 9px 11px -5px rgba(0,0,0,.2),0 18px 28px 2px rgba(0,0,0,.14),0 7px 34px 6px rgba(0,0,0,.12)}.MuiPaper-elevation19{box-shadow:0 9px 12px -6px rgba(0,0,0,.2),0 19px 29px 2px rgba(0,0,0,.14),0 7px 36px 6px rgba(0,0,0,.12)}.MuiPaper-elevation20{box-shadow:0 10px 13px -6px rgba(0,0,0,.2),0 20px 31px 3px rgba(0,0,0,.14),0 8px 38px 7px rgba(0,0,0,.12)}.MuiPaper-elevation21{box-shadow:0 10px 13px -6px rgba(0,0,0,.2),0 21px 33px 3px rgba(0,0,0,.14),0 8px 40px 7px rgba(0,0,0,.12)}.MuiPaper-elevation22{box-shadow:0 10px 14px -6px rgba(0,0,0,.2),0 22px 35px 3px rgba(0,0,0,.14),0 8px 42px 7px rgba(0,0,0,.12)}.MuiPaper-elevation23{box-shadow:0 11px 14px -7px rgba(0,0,0,.2),0 23px 36px 3px rgba(0,0,0,.14),0 9px 44px 8px rgba(0,0,0,.12)}.MuiPaper-elevation24{box-shadow:0 11px 15px -7px rgba(0,0,0,.2),0 24px 38px 3px rgba(0,0,0,.14),0 9px 46px 8px rgba(0,0,0,.12)}.MuiAppBar-root{width:100%;display:flex;z-index:1100;box-sizing:border-box;flex-shrink:0;flex-direction:column}.MuiAppBar-positionFixed{top:0;left:auto;right:0;position:fixed}@media print{.MuiAppBar-positionFixed{position:absolute}}.MuiAppBar-positionAbsolute{top:0;left:auto;right:0;position:absolute}.MuiAppBar-positionSticky{top:0;left:auto;right:0;position:sticky}.MuiAppBar-positionStatic{position:static}.MuiAppBar-positionRelative{position:relative}.MuiAppBar-colorDefault{color:rgba(0,0,0,.87);background-color:#f5f5f5}.MuiAppBar-colorPrimary{color:#fff;background-color:#3f51b5}.MuiAppBar-colorSecondary{color:#fff;background-color:#f50057}.MuiAppBar-colorInherit{color:inherit}.MuiAppBar-colorTransparent{color:inherit;background-color:transparent}.MuiToolbar-root{display:flex;position:relative;align-items:center}.MuiToolbar-gutters{padding-left:16px;padding-right:16px}@media (min-width:600px){.MuiToolbar-gutters{padding-left:24px;padding-right:24px}}.MuiToolbar-regular{min-height:56px}@media (min-width:0px) and (orientation:landscape){.MuiToolbar-regular{min-height:48px}}@media (min-width:600px){.MuiToolbar-regular{min-height:64px}}.MuiToolbar-dense{min-height:48px}.MuiButtonBase-root{color:inherit;border:0;cursor:pointer;margin:0;display:inline-flex;outline:0;padding:0;position:relative;align-items:center;user-select:none;border-radius:0;vertical-align:middle;-moz-appearance:none;justify-content:center;text-decoration:none;background-color:transparent;-webkit-appearance:none;-webkit-tap-highlight-color:transparent}.MuiButtonBase-root::-moz-focus-inner{border-style:none}.MuiButtonBase-root.Mui-disabled{cursor:default;pointer-events:none}@media print{.MuiButtonBase-root{color-adjust:exact}}.MuiIconButton-root{flex:0 0 auto;color:rgba(0,0,0,.54);padding:12px;overflow:visible;font-size:1.5rem;text-align:center;transition:background-color 150ms cubic-bezier(.4,0,.2,1) 0s;border-radius:50%}.MuiIconButton-root:hover{background-color:rgba(0,0,0,.04)}.MuiIconButton-root.Mui-disabled{color:rgba(0,0,0,.26);background-color:transparent}@media (hover:none){.MuiIconButton-root:hover{background-color:transparent}}.MuiIconButton-edgeStart{margin-left:-12px}.MuiIconButton-sizeSmall.MuiIconButton-edgeStart{margin-left:-3px}.MuiIconButton-edgeEnd{margin-right:-12px}.MuiIconButton-sizeSmall.MuiIconButton-edgeEnd{margin-right:-3px}.MuiIconButton-colorInherit{color:inherit}.MuiIconButton-colorPrimary{color:#3f51b5}.MuiIconButton-colorPrimary:hover{background-color:rgba(63,81,181,.04)}@media (hover:none){.MuiIconButton-colorPrimary:hover{background-color:transparent}}.MuiIconButton-colorSecondary{color:#f50057}.MuiIconButton-colorSecondary:hover{background-color:rgba(245,0,87,.04)}@media (hover:none){.MuiIconButton-colorSecondary:hover{background-color:transparent}}.MuiIconButton-sizeSmall{padding:3px;font-size:1.125rem}.MuiIconButton-label{width:100%;display:flex;align-items:inherit;justify-content:inherit}.MuiSvgIcon-root{fill:currentColor;width:1em;height:1em;display:inline-block;font-size:1.5rem;transition:fill .2s cubic-bezier(.4,0,.2,1) 0s;flex-shrink:0;user-select:none}.MuiSvgIcon-colorPrimary{color:#3f51b5}.MuiSvgIcon-colorSecondary{color:#f50057}.MuiSvgIcon-colorAction{color:rgba(0,0,0,.54)}.MuiSvgIcon-colorError{color:#f44336}.MuiSvgIcon-colorDisabled{color:rgba(0,0,0,.26)}.MuiSvgIcon-fontSizeInherit{font-size:inherit}.MuiSvgIcon-fontSizeSmall{font-size:1.25rem}.MuiSvgIcon-fontSizeLarge{font-size:2.1875rem}.MuiLink-underlineNone{text-decoration:none}.MuiLink-underlineHover{text-decoration:none}.MuiLink-underlineHover:hover{text-decoration:underline}.MuiLink-underlineAlways{text-decoration:underline}.MuiLink-button{border:0;cursor:pointer;margin:0;outline:0;padding:0;position:relative;user-select:none;border-radius:0;vertical-align:middle;-moz-appearance:none;background-color:transparent;-webkit-appearance:none;-webkit-tap-highlight-color:transparent}.MuiLink-button::-moz-focus-inner{border-style:none}.MuiLink-button.Mui-focusVisible{outline:auto}.MuiFab-root{color:rgba(0,0,0,.87);width:56px;height:56px;padding:0;font-size:.875rem;min-width:0;box-shadow:0 3px 5px -1px rgba(0,0,0,.2),0 6px 10px 0 rgba(0,0,0,.14),0 1px 18px 0 rgba(0,0,0,.12);box-sizing:border-box;min-height:36px;transition:background-color 250ms cubic-bezier(.4,0,.2,1) 0s,box-shadow 250ms cubic-bezier(.4,0,.2,1) 0s,border 250ms cubic-bezier(.4,0,.2,1) 0s;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:500;line-height:1.75;border-radius:50%;letter-spacing:.02857em;text-transform:uppercase;background-color:#e0e0e0}.MuiFab-root:active{box-shadow:0 7px 8px -4px rgba(0,0,0,.2),0 12px 17px 2px rgba(0,0,0,.14),0 5px 22px 4px rgba(0,0,0,.12)}.MuiFab-root:hover{text-decoration:none;background-color:#d5d5d5}.MuiFab-root.Mui-focusVisible{box-shadow:0 3px 5px -1px rgba(0,0,0,.2),0 6px 10px 0 rgba(0,0,0,.14),0 1px 18px 0 rgba(0,0,0,.12)}.MuiFab-root.Mui-disabled{color:rgba(0,0,0,.26);box-shadow:none;background-color:rgba(0,0,0,.12)}@media (hover:none){.MuiFab-root:hover{background-color:#e0e0e0}}.MuiFab-root:hover.Mui-disabled{background-color:rgba(0,0,0,.12)}.MuiFab-label{width:100%;display:inherit;align-items:inherit;justify-content:inherit}.MuiFab-primary{color:#fff;background-color:#3f51b5}.MuiFab-primary:hover{background-color:#303f9f}@media (hover:none){.MuiFab-primary:hover{background-color:#3f51b5}}.MuiFab-secondary{color:#fff;background-color:#f50057}.MuiFab-secondary:hover{background-color:#c51162}@media (hover:none){.MuiFab-secondary:hover{background-color:#f50057}}.MuiFab-extended{width:auto;height:48px;padding:0 16px;min-width:48px;min-height:auto;border-radius:24px}.MuiFab-extended.MuiFab-sizeSmall{width:auto;height:34px;padding:0 8px;min-width:34px;border-radius:17px}.MuiFab-extended.MuiFab-sizeMedium{width:auto;height:40px;padding:0 16px;min-width:40px;border-radius:20px}.MuiFab-colorInherit{color:inherit}.MuiFab-sizeSmall{width:40px;height:40px}.MuiFab-sizeMedium{width:48px;height:48px}.MuiContainer-root{width:100%;display:block;box-sizing:border-box;margin-left:auto;margin-right:auto;padding-left:16px;padding-right:16px}@media (min-width:600px){.MuiContainer-root{padding-left:24px;padding-right:24px}}.MuiContainer-disableGutters{padding-left:0;padding-right:0}@media (min-width:600px){.MuiContainer-fixed{max-width:600px}}@media (min-width:960px){.MuiContainer-fixed{max-width:960px}}@media (min-width:1280px){.MuiContainer-fixed{max-width:1280px}}@media (min-width:1920px){.MuiContainer-fixed{max-width:1920px}}@media (min-width:0px){.MuiContainer-maxWidthXs{max-width:444px}}@media (min-width:600px){.MuiContainer-maxWidthSm{max-width:600px}}@media (min-width:960px){.MuiContainer-maxWidthMd{max-width:960px}}@media (min-width:1280px){.MuiContainer-maxWidthLg{max-width:1280px}}@media (min-width:1920px){.MuiContainer-maxWidthXl{max-width:1920px}}.MuiCard-root{overflow:hidden}.jss12{right:16px;bottom:16px;position:fixed}.jss10{color:#fff;background-color:#3f51b5}.jss11{color:#fff;background-color:#3f51b5}.jss7{color:#fff;padding:48px 16px;margin-top:64px;background-color:#3f51b5}.MuiDivider-root{border:none;height:1px;margin:0;flex-shrink:0;background-color:rgba(0,0,0,.12)}.MuiDivider-absolute{left:0;width:100%;bottom:0;position:absolute}.MuiDivider-inset{margin-left:72px}.MuiDivider-light{background-color:rgba(0,0,0,.08)}.MuiDivider-middle{margin-left:16px;margin-right:16px}.MuiDivider-vertical{width:1px;height:100%}.MuiDivider-flexItem{height:auto;align-self:stretch}.MuiCardMedia-root{display:block;background-size:cover;background-repeat:no-repeat;background-position:center}.MuiCardMedia-media{width:100%}.MuiCardMedia-img{object-fit:cover}.jss1{height:210px}.jss2{font-size:14px;padding-top:16px}.jss3{font-size:14px}</style><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><link as="script" rel="preload" href="/webpack-runtime-680c0937166e62c2050f.js"/><link as="script" rel="preload" href="/framework-a6306eaaf8346efc791c.js"/><link as="script" rel="preload" href="/app-3de87ef8925a61ac1063.js"/><link as="script" rel="preload" href="/commons-7366a34b018bd46c988c.js"/><link as="script" rel="preload" href="/875d5575f84d2db311b8feddedb7ed30b8fce884-550ed5cb8e4ee8e56024.js"/><link as="script" rel="preload" href="/component---src-templates-article-page-template-js-294b453dd171938e00b3.js"/><link as="fetch" rel="preload" href="/page-data/articles/node--session-authentication-example/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/4011214723.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><header class="MuiPaper-root MuiAppBar-root MuiAppBar-positionFixed MuiAppBar-colorPrimary mui-fixed MuiPaper-elevation0"><div class="MuiToolbar-root MuiToolbar-regular MuiToolbar-gutters"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-edgeStart" tabindex="0" type="button" aria-label="menu"><span class="MuiIconButton-label"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg></span></button><h6 class="MuiTypography-root MuiTypography-subtitle1 MuiTypography-colorInherit">Session management for web applications</h6></div></header><div class="MuiToolbar-root MuiToolbar-regular MuiToolbar-gutters" id="back-to-top-anchor"></div><div class="MuiContainer-root MuiBox-root jss4 MuiContainer-maxWidthMd"><div class="MuiPaper-root MuiCard-root MuiPaper-elevation1 MuiPaper-rounded"><div class="MuiCardMedia-root jss1" style="background-image:url(&quot;https://source.unsplash.com/random?spring&quot;)"></div><div class="MuiBox-root jss5"><div><p>A web session is a sequence of network HTTP request and response transactions associated with the same user. Modern and
complex web applications require the retaining of information or status about each user for the duration of multiple
requests. Therefore, sessions provide the ability to establish variables – such as access rights and localization
settings – which will apply to each and every interaction a user has with the web application for the duration of
the session.</p>
<h1>Session management for web applications</h1>
<p>Web applications can create sessions to keep track of anonymous users after the very first user request. An example
would be maintaining the user language preference. Additionally, web applications will make use of sessions once the
user has authenticated. This ensures the ability to identify the user on any subsequent requests as well as being able
to apply security access controls, authorized access to the user private data, and to increase the usability of the
application. Therefore, current web applications can provide session capabilities both pre and post authentication.</p>
<p>Once an authenticated session has been established, the session ID (or token) is temporarily equivalent to the strongest
authentication method used by the application, such as username and password, passphrases, one-time passwords (OTP),
client-based digital certificates, smartcards, or biometrics (such as fingerprint or eye retina).</p>
<p>HTTP is a stateless protocol (<a href="https://www.ietf.org/rfc/rfc2616.txt">RFC2616 section 5</a>), where each request and response
pair is independent of other web interactions. Therefore, in order to introduce the concept of a session, it is required
to implement session management capabilities that link both the authentication and access control (or authorization)
modules commonly available in web applications.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 753px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/36d3c80e98dcb8157df9ad88f329baba/17a7a/Session_Management_Cheat_Sheet_Diagram.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 22.76785714285714%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABcSAAAXEgFnn9JSAAABeUlEQVQY0yWQXS9bcQCHz5dBFuFOZDNv32GJl50hp6HeM5FIXJClXho2RJrRlEgkLtTr2EWl0SpFJ0VCNla1RZVdbKnqqWocp579cfHk91w8Vz8pEte4jN7h/hnDdRxjVeAJxLjVdO71FH9VjUgiReRG559wPfVAPKnjPr4W/TOPfnWjkbwH6Z1pnpaJPV6btijs2qRA8OqDl4Nzlf1f1ygWPzXDGxgtm1SP7HMUVtkORnlp8one+9QX9u5gcZ7Ral1HUpQemszz5DbYyG+0kddgJa9xjMmNEEuuAIpxELnKRKWhl/rmEb56Thl3/6a4fYGcqj5yKswUCR+y76HUfUIaLTHQ2TFKujxAttxPlvyRF6VmvEcXhPyHjMvNTNW0PTFR+Z4/309w7J6S9qaLzLIeMku7ySjvw2pb5vPbWqQLl4vgjwB25w52xxbTjm3mnN/ET3doqkpozUPYs05Y7LlY/TZBNJ5gZsWH/RGHj9lVP6HgGSeLX/gPkfIsY8D35mMAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="SessionAuthentication"
        title="Session management"
        src="/static/36d3c80e98dcb8157df9ad88f329baba/17a7a/Session_Management_Cheat_Sheet_Diagram.png"
        srcset="/static/36d3c80e98dcb8157df9ad88f329baba/80b2d/Session_Management_Cheat_Sheet_Diagram.png 224w,
/static/36d3c80e98dcb8157df9ad88f329baba/33b38/Session_Management_Cheat_Sheet_Diagram.png 448w,
/static/36d3c80e98dcb8157df9ad88f329baba/17a7a/Session_Management_Cheat_Sheet_Diagram.png 753w"
        sizes="(max-width: 753px) 100vw, 753px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>The session ID or token binds the user authentication credentials (in the form of a user session) to the user HTTP
traffic and, the appropriate access controls enforced by the web application. The complexity of these three components
(authentication, session management, and access control) in modern web applications, plus the fact that its
implementation and binding resides on the web developer's hands (as web development frameworks do not provide strict
relationships between these modules), makes the implementation of a secure session management module very challenging.</p>
<h1>Session management implementation</h1>
<p>The session management implementation defines the exchange mechanism that will be used between the user and, the web
application to share and continuously exchange the session ID. There are multiple mechanisms available in HTTP to
maintain session state within web applications, such as cookies (standard HTTP header),
URL parameters (URL rewriting – <a href="https://www.ietf.org/rfc/rfc2396.txt">RFC2396</a>), URL arguments on GET requests, body
arguments on POST requests, such as hidden form fields (HTML forms), or proprietary HTTP headers.</p>
<p>The preferred session ID exchange mechanism should allow defining advanced token properties, such as the token expiration
date and time, or granular usage constraints. This is one of the reasons why cookies (RFCs <a href="https://www.ietf.org/rfc/rfc2109.txt">2109</a> &#x26;
<a href="https://www.ietf.org/rfc/rfc2965.txt">2965</a> &#x26; <a href="https://www.ietf.org/rfc/rfc6265.txt">6265</a>) are one of the most extensively used session ID exchange mechanisms, offering advanced capabilities not available in
other methods.</p>
<p>The usage of specific session ID exchange mechanisms, such as those where the ID is included in the URL, might disclose
the session ID (in web links and logs, web browser history and bookmarks, the Referer header or search engines), as well
as facilitate other attacks, such as the manipulation of the ID or <a href="http://www.acrossecurity.com/papers/session_fixation.pdf">session fixation attacks</a>.</p>
<h2>Cookies</h2>
<p>Session management mechanisms based on cookies can make use of two types of cookies, non-persistent (or session)
cookies, and persistent cookies. If a cookie presents the Max-Age (that has preference over Expires) or Expires
attributes, it will be considered a persistent cookie and will be stored on disk by the web browser based until the
expiration time.</p>
<p>The session ID exchange mechanism based on cookies provides multiple security features in the form of cookie attributes
that can be used to protect the exchange of the session ID, Secure, HttpOnly, Expires, maxAge attributes, etc.</p>
<h3>Secure attribute</h3>
<p>The Secure cookie attribute instructs web browsers to only send the cookie through an encrypted HTTPS (SSL/TLS)
connection. This session protection mechanism is mandatory to prevent the disclosure of the session ID through MitM
(Man-in-the-Middle) attacks. It ensures that an attacker cannot simply capture the session ID from web browser traffic.</p>
<p>Forcing the web application to only use HTTPS for its communication (even when port TCP/80, HTTP, is closed in the web
application host) does not protect against session ID disclosure if the Secure cookie has not been set - the web
browser can be deceived to disclose the session ID over an unencrypted HTTP connection. The attacker can intercept
and manipulate the victim user traffic and inject an HTTP unencrypted reference to the web application that will force
the web browser to submit the session ID in the clear.</p>
<h3>HttpOnly attribute</h3>
<p>The HttpOnly cookie attribute instructs web browsers not to allow scripts (e.g. JavaScript or VBscript) an ability to
access the cookies via the DOM document.cookie object. This session ID protection is mandatory to prevent session ID
stealing through XSS attacks. However, if an XSS attack is combined with a CSRF attack, the requests sent to the web
application will include the session cookie, as the browser always includes the cookies when sending requests. The
HttpOnly cookie only protects the confidentiality of the cookie; the attacker cannot use it offline, outside of the
context of an XSS attack.</p>
<h3>SameSite attribute</h3>
<p>SameSite allows a server define a cookie attribute making it impossible to the browser send this cookie along with
cross-site requests. The main goal is to mitigate the risk of cross-origin information leakage, and provides some
protection against cross-site request forgery attacks.</p>
<h3>Expire and maxAge attributes</h3>
<p>Session management mechanisms based on cookies can make use of two types of cookies, non-persistent (or session)
cookies, and persistent cookies. If a cookie presents the Max-Age (that has preference over Expires) or Expires
attributes, it will be considered a persistent cookie and will be stored on disk by the web browser based until the
expiration time.</p>
<p>Typically, session management capabilities to track users after authentication make use of non-persistent cookies.
This forces the session to disappear from the client if the current web browser instance is closed. Therefore, it is
highly recommended to use non-persistent cookies for session management purposes, so that the session ID does not
remain on the web client cache for long periods of time, from where an attacker can obtain it.</p>
<ul>
<li>Ensure that sensitive information is not comprised, by ensuring that sensitive information is not persistent /
encrypting / stored on a need basis for the duration of the need.</li>
<li>Ensure that unauthorized activities cannot take place via cookie manipulation.</li>
<li>Ensure secure flag is set to prevent accidental transmission over "the wire" in a non-secure manner.</li>
<li>Determine if all state transitions in the application code properly check for the cookies and enforce their use</li>
<li>Ensure entire cookie should be encrypted if sensitive data is persisted in the cookie</li>
<li>Define all cookies being used by the application, their name and why they are needed</li>
</ul>
<h2>Session id lifecycle</h2>
<p>There are two types of session management mechanisms for web applications, permissive and strict, related to session
fixation vulnerabilities. The permissive mechanism allows the web application to initially accept any session ID value
set by the user as valid, creating a new session for it, while the strict mechanism enforces that the web application
will only accept session ID values that have been previously generated by the web application.</p>
<p>The session tokens should be handled by the web server if possible or generated via a cryptographically secure random
number generator.</p>
<p>Although the most common mechanism in use today is the strict one (more secure), PHP defaults to permissive. Developers
must ensure that the web application does not use a permissive mechanism under certain circumstances. Web applications
should never accept a session ID they have never generated, and in case of receiving one, they should generate and
offer the user a new valid session ID. Additionally, this scenario should be detected as a suspicious activity and,
an alert should be generated.</p>
<h3>Manage Session ID as Any Other User Input</h3>
<p>Session IDs must be considered untrusted, as any other user input processed by the web application, and they must be
thoroughly validated and verified. Depending on the session management mechanism used, the session ID will be received
in a GET or POST parameter, in the URL or in an HTTP header (e.g. cookies). If web applications do not validate and
filter out invalid session ID values before processing them, they can potentially be used to exploit other web
vulnerabilities, such as SQL injection if the session IDs are stored on a relational database, or persistent XSS if the
session IDs are stored and reflected back afterwards by the web application.</p>
<h3>Renew the Session ID After Any Privilege Level Change</h3>
<p>The session ID must be renewed or regenerated by the web application after any privilege level change within the
associated user session. The most common scenario where the session ID regeneration is mandatory is during the
authentication process, as the privilege level of the user changes from the unauthenticated (or anonymous) state to
the authenticated state. Other common scenarios must also be considered, such as password changes, permission changes
or switching from a regular user role to an administrator role within the web application. For all these web application
critical pages, previous session IDs have to be ignored, a new session ID must be assigned to every new request
received for the critical resource, and the old or previous session ID must be destroyed.</p>
<p>The session ID regeneration is mandatory to prevent session fixation attacks, where an attacker sets the session ID on
the victim user's web browser instead of gathering the victim's session ID, as in most of the other session-based
attacks, and independently of using HTTP or HTTPS. This protection mitigates the impact of other web-based
vulnerabilities that can also be used to launch session fixation attacks, such as HTTP response splitting or XSS
(see here and here).</p>
<p>A complementary recommendation is to use a different session ID or token name (or set of session IDs) pre and post
authentication, so that the web application can keep track of anonymous users and authenticated users without the
risk of exposing or binding the user session between both states.</p>
<h2>Session expiration</h2>
<p>In order to minimize the time period an attacker can launch attacks over active sessions and hijack them, it is
mandatory to set expiration timeouts for every session, establishing the amount of time a session will remain active.
Insufficient session expiration by the web application increases the exposure of other session-based attacks, as for
the attacker to be able to reuse a valid session ID and hijack the associated session, it must still be active.</p>
<p>The shorter the session interval is, the lesser the time an attacker has to use the valid session ID. The session
expiration timeout values must be set accordingly with the purpose and nature of the web application, and balance
security and usability, so that the user can comfortably complete the operations within the web application without
his session frequently expiring.</p>
<p>Both the idle and absolute timeout values are highly dependent on how critical the web application and its data are.
Common idle timeouts ranges are 2-5 minutes for high-value applications and 15-30 minutes for low risk applications.
Absolute timeouts depend on how long a user usually uses the application. If the application is intended to be used
by an office worker for a full day, an appropriate absolute timeout range could be between 4 and 8 hours.</p>
<p>When a session expires, the web application must take active actions to invalidate the session on both sides, client
and server. The latter is the most relevant and mandatory from a security perspective.</p>
<p>For most session exchange mechanisms, client side actions to invalidate the session ID are based on clearing out the
token value. For example, to invalidate a cookie it is recommended to provide an empty (or invalid) value for the
session ID, and set the Expires (or Max-Age) attribute to a date from the past (in case a persistent cookie is
being used): Set-Cookie: id=; Expires=Friday, 17-May-03 18:45:00 GMT.</p>
<p>In order to close and invalidate the session on the server side, it is mandatory for the web application to take active
actions when the session expires, or the user actively logs out.</p>
<h3>Automatic Session Expiration</h3>
<h4>Idle timeout</h4>
<p>All sessions should implement an idle or inactivity timeout. This timeout defines the amount of time a session will
remain active in case there is no activity in the session, closing and invalidating the session upon the defined idle
period since the last HTTP request received by the web application for a given session ID.</p>
<p>The idle timeout limits the chances an attacker has to guess and use a valid session ID from another user. However,
if the attacker is able to hijack a given session, the idle timeout does not limit the attacker's actions, as he can
generate activity on the session periodically to keep the session active for longer periods of time.</p>
<p>Session timeout management and expiration must be enforced server-side. If the client is used to enforce the session
timeout, for example using the session token or other client parameters to track time references (e.g. number of
minutes since login time), an attacker could manipulate these to extend the session duration.</p>
<h4>Absolute timeout</h4>
<p>All sessions should implement an absolute timeout, regardless of session activity. This timeout defines the maximum
amount of time a session can be active, closing and invalidating the session upon the defined absolute period since
the given session was initially created by the web application. After invalidating the session, the user is forced to
(re)authenticate again in the web application and establish a new session.</p>
<p>The absolute session limits the amount of time an attacker can use a hijacked session and impersonate the victim user.</p>
<h4>Renewal timeout</h4>
<p>Alternatively, the web application can implement an additional renewal timeout after which the session ID is
automatically renewed, in the middle of the user session, and independently of the session activity and, therefore,
of the idle timeout.</p>
<p>After a specific amount of time since the session was initially created, the web application can regenerate a new ID
for the user session and try to set it, or renew it, on the client. The previous session ID value would still be valid
for some time, accommodating a safety interval, before the client is aware of the new ID and starts using it. At that
time, when the client switches to the new ID inside the current session, the application invalidates the previous ID.</p>
<p>This scenario minimizes the amount of time a given session ID value, potentially obtained by an attacker, can be reused
to hijack the user session, even when the victim user session is still active. The user session remains alive and open
on the legitimate client, although its associated session ID value is transparently renewed periodically during the
session duration, every time the renewal timeout expires. Therefore, the renewal timeout complements the idle and
absolute timeouts, specially when the absolute timeout value extends significantly over time (e.g. it is an application
requirement to keep the user sessions open for long periods of time).</p>
<p>Depending on the implementation, potentially there could be a race condition where the attacker with a still valid
previous session ID sends a request before the victim user, right after the renewal timeout has just expired, and
obtains first the value for the renewed session ID. At least in this scenario, the victim user might be aware of the
attack as her session will be suddenly terminated because her associated session ID is not valid anymore.</p>
<h3>Manual Session Expiration</h3>
<p>Web applications should provide mechanisms that allow security aware users to actively close their session once they
have finished using the web application.</p>
<h4>Logout button</h4>
<p>Web applications must provide a visible and easily accessible logout (logoff, exit, or close session) button that is
available on the web application header or menu and reachable from every web application resource and page, so that
the user can manually close the session at any time.</p>
<h3>Web content caching</h3>
<p>Even after the session has been closed, it might be possible to access the private or sensitive data exchanged within
the session through the web browser cache. Therefore, web applications must use restrictive cache directives for all
the web traffic exchanged through HTTP and HTTPS, such as the Cache-Control and Pragma HTTP headers, and/or equivalent
META tags on all or (at least) sensitive web pages.</p>
<p>Independently of the cache policy defined by the web application, if caching web application contents is allowed, the
session IDs must never be cached, so it is highly recommended using the
Cache-Control: no-cache="Set-Cookie, Set-Cookie2" directive, to allow web clients to cache everything except the
session ID (see here).</p>
<h2>Additional Client-Side Defenses for Session Management</h2>
<p>Web applications can complement the previously described session management defenses with additional countermeasures on
the client side. Client-side protections, typically in the form of JavaScript checks and verifications, are not
bullet-proof and can easily be defeated by a skilled attacker, but can introduce another layer of defense that has to
be bypassed by intruders.</p>
<h3>Initial login timeout</h3>
<p>Web applications can use JavaScript code in the login page to evaluate and measure the amount of time since the page
was loaded and, a session ID was granted. If a login attempt is tried after a specific amount of time, the client code
can notify the user that the maximum amount of time to log in has passed and reload the login page, hence retrieving a
new session ID.</p>
<p>This extra protection mechanism tries to force the renewal of the session ID pre-authentication, avoiding scenarios
where a previously used (or manually set) session ID is reused by the next victim using the same computer, for example,
in session fixation attacks.</p>
<h3>Force Session Logout On Web Browser Window Close Events</h3>
<p>Web applications can use JavaScript code to capture all the web browser tab or window close (or even back) events and
take the appropriate actions to close the current session before closing the web browser, emulating that the user has
manually closed the session via the logout button.</p>
<h3>Disable Web Browser Cross-Tab Sessions</h3>
<p>Web applications can use JavaScript code once the user has logged in and a session has been established to force the
user to re-authenticate if a new web browser tab or window is opened against the same web application. The web
application does not want to allow multiple web browser tabs or windows to share the same session. Therefore, the
application tries to force the web browser to not share the same session ID simultaneously between them.</p>
<blockquote>
<p>NOTE: This mechanism cannot be implemented if the session ID is exchanged through cookies, as cookies are shared by
all web browser tabs/windows.</p>
</blockquote>
<h3>Automatic client logout</h3>
<p>JavaScript code can be used by the web application in all (or critical) pages to automatically logout client sessions
after the idle timeout expires, for example, by redirecting the user to the logout page (the same resource used by the
logout button mentioned previously).</p>
<p>The benefit of enhancing the server-side idle timeout functionality with client-side code is that the user can see that
the session has finished due to inactivity, or even can be notified in advance that the session is about to expire
through a count down timer and warning messages. This user-friendly approach helps to avoid loss of work in web pages
that require extensive input data due to server-side silently expired sessions.</p>
<h1>Node.js session management</h1>
<p>When using Express.js, the de-facto standard package express-session supports session management and is often used
with passport for authentication. For example, in session-based authentication, after a user authenticate, the web
server send a cookie back to the web browser containing a session id. At the same time, the web server will also store
the session id and, information about the authenticated user in a session store.</p>
<p>Next time the web browser send a request to the web server, the request will contain this cookie and, the web server use
the session id stored in the cookie to load user information from the session store. You can
consider this phase as the web server authenticate the user performing the request from the web browser.</p>
<p>It's also important to know that cookies as exchange mechanism can exist as a session cookie or a permanent cookie. A
session cookie has no maxAge or expires attributes set, instead they expire either when a user logout or close the web
browser. A session cookie is not either </p>
<p>If the cookie has expired, it will not be sent in the request thus the web server can not authenticate the user via the
session store meaning the user is not authenticated, the session has expired, the user needs to authenticate again.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 801px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/ec224d2a1afedd60e0d42c4f168018d9/d5834/session-based-authentication.jpg"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 58.03571428571428%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAd4QVX//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAEFAl//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAZEAACAwEAAAAAAAAAAAAAAAAAARBBYSH/2gAIAQEAAT8hS0sTwS4XH//aAAwDAQACAAMAAAAQCw//xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAwEBPxBn/8QAFhEAAwAAAAAAAAAAAAAAAAAAARAx/9oACAECAQE/EBF//8QAHBABAAMAAgMAAAAAAAAAAAAAAQARITFBgZHw/9oACAEBAAE/EErn4ga2I2Wxre4AOfcDZKPmf//Z'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="SessionAuthentication"
        title="Session based authentication"
        src="/static/ec224d2a1afedd60e0d42c4f168018d9/d5834/session-based-authentication.jpg"
        srcset="/static/ec224d2a1afedd60e0d42c4f168018d9/2bad8/session-based-authentication.jpg 224w,
/static/ec224d2a1afedd60e0d42c4f168018d9/fb05c/session-based-authentication.jpg 448w,
/static/ec224d2a1afedd60e0d42c4f168018d9/d5834/session-based-authentication.jpg 801w"
        sizes="(max-width: 801px) 100vw, 801px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<h2>When to use session-based authentication</h2>
<p>Session-based authentication is common if you have a full controlled on the server-side, having the server to control
the state of the application will ease the client side, and create a more robust application. Session-based
authentication is great for browser based applications and, it can restrict or limit session to certain operation or
certain time period and, it can invalidate user if there are any security concerns.</p>
<p>Session-based authentication is also common in environments where you do not need to scale up your system horizontally
(adding new replicated server instances). In other words, where your number of users is not massive or predictable.
If you need to scale up with more servers it's common to use a dedicated session server such as Redis to be a central
session store your servers can access.</p>
<p>Session-based authentication is also quite secure for its use case, by setting HttpOnly flag when generating a cookie
helps mitigate the risk of client side script (XSS-attack) accessing the protected cookie.</p>
<p>Further, cookies can be created with a secure flag setting in the cookie that prevents cookie transmission
through unencrypted channels thus eliminate MiTM-attack (Manipulator in The Middle attack). The secure flag in the
cookie ensures the browser only sends the cookie over HTTPS.</p>
<blockquote>
<p>The session-based authentication does implement a fair amount of protection for its use case, but you need to secure
your application using complimentary methods as well.</p>
</blockquote>
<h2>Code example in Node.js</h2>
<p>In Node.js it is common practice to use express-session for Connect styled backends. express-session is a middleware
you use where you configure the settings as well as the session store you choose. Below is an example of the
configuration and how to apply the middleware to an express application.</p>
<div class="gatsby-highlight" data-language="typescript"><pre style="counter-reset: linenumber NaN" class="language-typescript line-numbers"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> Express <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'express'</span>
<span class="token keyword">import</span> session<span class="token punctuation">,</span> <span class="token punctuation">{</span> Cookie <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'express-session'</span>
<span class="token keyword">import</span> MongoStore <span class="token keyword">from</span> <span class="token string">'connect-mongo'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> connectionOpts <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../../database/mongo/DbClient'</span>

<span class="token comment">/**
 * Session middleware configuration
 */</span>
<span class="token keyword">const</span> sessionConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'example.sid'</span><span class="token punctuation">,</span>
  resave<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  saveUninitialized<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  secret<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">SESSION_SECRET</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * Session duration settings
 */</span>
<span class="token keyword">const</span> sessionDuration <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">SESSION_DURATION</span><span class="token punctuation">)</span>

<span class="token comment">/**
 * Cookie configuration
 */</span>
<span class="token keyword">const</span> cookieConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
  httpOnly<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// Will not allow client-side JavaScript to access cookie in document.cookie</span>
  secure<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>  <span class="token comment">// Ensures the cookie is sent only over HTTP(S), </span>
                  <span class="token comment">// to protect against cross-site scripting attacks.</span>
  sameSite<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// cors</span>
  maxAge<span class="token operator">:</span> sessionDuration<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * Session store options
 */</span>
<span class="token keyword">const</span> storeOptions <span class="token operator">=</span> <span class="token punctuation">{</span>
  mongoUrl<span class="token operator">:</span> connectionOpts<span class="token punctuation">.</span>connectionURI<span class="token punctuation">,</span>
  mongoOptions<span class="token operator">:</span> connectionOpts<span class="token punctuation">.</span>options<span class="token punctuation">,</span>
  dbName<span class="token operator">:</span> <span class="token string">'UserDb'</span><span class="token punctuation">,</span>
  ttl<span class="token operator">:</span> sessionDuration <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * Apply session management to express app
 * @param app
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">applySession</span><span class="token punctuation">(</span>app<span class="token operator">:</span> Express<span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token comment">// In production mode - set the secure flag to true to use HTTPS</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>app<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'env'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    app<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">'trust proxy'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// trust first proxy</span>
    cookieConfig<span class="token punctuation">.</span>secure <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>

  app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
    <span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token operator">...</span>sessionConfig<span class="token punctuation">,</span>
      cookie<span class="token operator">:</span> cookieConfig<span class="token punctuation">,</span>
      store<span class="token operator">:</span> MongoStore<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>storeOptions<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>The express-session middleware ensure creating a cookie (if no one was sent in the request) or load the cookie from the
session store if a cookie was in the request. To ensure authentication in request containing the cookie we can implement
another middleware as the example below;</p>
<div class="gatsby-highlight" data-language="typescript"><pre style="counter-reset: linenumber NaN" class="language-typescript line-numbers"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> NextFunction<span class="token punctuation">,</span> Request<span class="token punctuation">,</span> Response <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'express'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ServiceLogger <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@hgc-sdk/logger'</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserMiddleware</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> logger<span class="token operator">:</span> ServiceLogger
  <span class="token keyword">constructor</span><span class="token punctuation">(</span>logger<span class="token operator">:</span> ServiceLogger<span class="token punctuation">,</span> oauthService<span class="token operator">:</span> IOAuthService<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>logger <span class="token operator">=</span> logger
  <span class="token punctuation">}</span>
  
  <span class="token comment">/**
   * Authenticate user against the session store of session cookie exist
   */</span>
  <span class="token keyword">public</span> <span class="token function-variable function">ensureAuthenticated</span> <span class="token operator">=</span> <span class="token punctuation">(</span>req<span class="token operator">:</span> Request<span class="token punctuation">,</span> res<span class="token operator">:</span> Response<span class="token punctuation">,</span> next<span class="token operator">:</span> NextFunction<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>session <span class="token operator">&amp;&amp;</span> req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// If session AND user exist - express session has loaded the </span>
      <span class="token comment">// user information from the session store based on the cookie in the request</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span>session<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// express-session has created a new cookie and our authetication code should</span>
      <span class="token comment">// update the req.session with user information if authetication succeed</span>
    <span class="token punctuation">}</span>

    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>XSS-attack</h2>
<p>Cross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise
benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally
in the form of a browser side script, to a different end user. Flaws that allow these attacks to succeed are quite
widespread and occur anywhere a web application uses input from a user within the output it generates without validating
or encoding it.</p>
<p>An attacker can use XSS to send a malicious script to an unsuspecting user. The end user’s browser has no way to know
that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted
source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the
browser and used with that site. These scripts can even rewrite the content of the HTML page.</p>
<h2>MiTM-attack</h2>
<p>The Manipulator-in-the middle attack (MITM) intercepts a communication between two systems. For example, in a http
transaction the target is the TCP connection between client and server. Using different techniques, the attacker splits
the original TCP connection into 2 new connections, one between the client and the attacker and the other between the
attacker and the server. Once the TCP connection is intercepted, the attacker acts as a proxy, being able to read,
insert and modify the data in the intercepted communication.</p>
<p>The MITM attack could also be done over a https connection by using the same technique; the only difference consists in
the establishment of two independent SSL sessions, one over each TCP connection. The browser sets an SSL connection
with the attacker, and the attacker establishes another SSL connection with the web server. In general the browser
warns the user that the digital certificate used is not valid, but the user may ignore the warning because they don’t
understand the threat. In some specific contexts it’s possible that the warning does not appear, as for example, when
the Server certificate is compromised by the attacker or when the attacker certificate is signed by a trusted CA and,
the CN is the same of the original web-site.</p>
<h2>References</h2>
<ul>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html">OWASP Authentication Cheat Sheet</a></li>
<li>Set Cookie: <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie">Set Cookie</a></li>
<li>XSS-attack: <a href="https://owasp.org/www-community/attacks/xss/">Cross-Site-Scripting (XSS) attacks</a></li>
<li>MiTM attack: <a href="https://owasp.org/www-community/attacks/Manipulator-in-the-middle_attack">MiTM attacks</a></li>
</ul></div><div class="MuiBox-root jss6"><hr class="MuiDivider-root"/></div><h6 class="MuiTypography-root MuiTypography-subtitle2 MuiTypography-colorTextSecondary">Published: <!-- -->2021-04-23</h6><h6 class="MuiTypography-root MuiTypography-subtitle2 MuiTypography-colorTextSecondary">PublishedBy: <!-- -->Henrik Grönvall</h6></div></div></div><div class="MuiBox-root jss8 jss7"><h6 class="MuiTypography-root MuiTypography-subtitle2 MuiTypography-gutterBottom">Henrik Grönvall</h6><div class="MuiBox-root jss9"><a class="MuiTypography-root MuiLink-root MuiLink-underlineHover MuiButtonBase-root MuiIconButton-root jss10 MuiTypography-colorPrimary" tabindex="0" role="button" aria-disabled="false" aria-label="github" href="https://github.com/HenrikGr" target="_blank" rel="noopener noreferrer"><span class="MuiIconButton-label"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 .3a12 12 0 0 0-3.8 23.4c.6.1.8-.3.8-.6v-2c-3.3.7-4-1.6-4-1.6-.6-1.4-1.4-1.8-1.4-1.8-1-.7.1-.7.1-.7 1.2 0 1.9 1.2 1.9 1.2 1 1.8 2.8 1.3 3.5 1 0-.8.4-1.3.7-1.6-2.7-.3-5.5-1.3-5.5-6 0-1.2.5-2.3 1.3-3.1-.2-.4-.6-1.6 0-3.2 0 0 1-.3 3.4 1.2a11.5 11.5 0 0 1 6 0c2.3-1.5 3.3-1.2 3.3-1.2.6 1.6.2 2.8 0 3.2.9.8 1.3 1.9 1.3 3.2 0 4.6-2.8 5.6-5.5 5.9.5.4.9 1 .9 2.2v3.3c0 .3.1.7.8.6A12 12 0 0 0 12 .3"></path></svg></span></a><a class="MuiTypography-root MuiLink-root MuiLink-underlineHover MuiButtonBase-root MuiIconButton-root jss11 MuiTypography-colorPrimary" tabindex="0" role="button" aria-disabled="false" aria-label="email" href="mailto:hgc-ab@outlook.com" target="_blank" rel="noopener noreferrer"><span class="MuiIconButton-label"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"></path></svg></span></a></div><h6 class="MuiTypography-root MuiTypography-subtitle2 MuiTypography-alignRight">Copyright © <!-- -->2021<!-- --> <!-- -->Henrik Grönvall Consulting AB</h6></div><div role="presentation" class="jss12" style="transform:scale(0);visibility:hidden"><button class="MuiButtonBase-root MuiFab-root MuiFab-secondary" tabindex="0" type="button" aria-label="scroll back to top"><span class="MuiFab-label"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path></svg></span></button></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-152419885-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/articles/node--session-authentication-example/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-7b669ef4db2dfbd0e5b6.js"],"app":["/app-3de87ef8925a61ac1063.js"],"component---src-pages-404-js":["/component---src-pages-404-js-071029e285e911a7bac5.js"],"component---src-pages-articles-js":["/component---src-pages-articles-js-478f57e4107808e2528a.js"],"component---src-pages-index-js":["/component---src-pages-index-js-3c7dcf7c7a8d894ce57a.js"],"component---src-pages-projects-js":["/component---src-pages-projects-js-f3f7e91543f3486f2978.js"],"component---src-templates-about-page-template-js":["/component---src-templates-about-page-template-js-1af314a48b8dc011fd11.js"],"component---src-templates-article-page-template-js":["/component---src-templates-article-page-template-js-294b453dd171938e00b3.js"],"component---src-templates-articles-tags-template-js":["/component---src-templates-articles-tags-template-js-3fb675d6167759d3f49d.js"],"component---src-templates-project-page-template-js":["/component---src-templates-project-page-template-js-8959331364e361f3172d.js"]};/*]]>*/</script><script src="/polyfill-7b669ef4db2dfbd0e5b6.js" nomodule=""></script><script src="/component---src-templates-article-page-template-js-294b453dd171938e00b3.js" async=""></script><script src="/875d5575f84d2db311b8feddedb7ed30b8fce884-550ed5cb8e4ee8e56024.js" async=""></script><script src="/commons-7366a34b018bd46c988c.js" async=""></script><script src="/app-3de87ef8925a61ac1063.js" async=""></script><script src="/framework-a6306eaaf8346efc791c.js" async=""></script><script src="/webpack-runtime-680c0937166e62c2050f.js" async=""></script></body></html>