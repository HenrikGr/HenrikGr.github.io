<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.c8a84733615ef483a4fb.css" id="gatsby-global-css">code[class*=language-],pre[class*=language-]{text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;color:#eee;background:#272822;font-family:Roboto Mono,monospace;font-size:1em;line-height:1.5em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#363636}:not(pre)>code[class*=language-]{white-space:normal;border-radius:.2em;padding:.1em}pre[class*=language-]{overflow:auto;position:relative;margin:.5em 0;padding:1.25em 1em}.language-css>code,.language-sass>code,.language-scss>code{color:#fd9170}[class*=language-] .namespace{opacity:.7}.token.atrule{color:#c792ea}.token.attr-name{color:#ffcb6b}.token.attr-value,.token.attribute{color:#a5e844}.token.boolean{color:#c792ea}.token.builtin{color:#ffcb6b}.token.cdata,.token.char{color:#80cbc4}.token.class{color:#ffcb6b}.token.class-name{color:#f2ff00}.token.comment{color:#616161}.token.constant{color:#c792ea}.token.deleted{color:#f66}.token.doctype{color:#616161}.token.entity{color:#f66}.token.function{color:#c792ea}.token.hexcode{color:#f2ff00}.token.id,.token.important{color:#c792ea;font-weight:700}.token.inserted{color:#80cbc4}.token.keyword{color:#c792ea}.token.number{color:#fd9170}.token.operator{color:#89ddff}.token.prolog{color:#616161}.token.property{color:#80cbc4}.token.pseudo-class,.token.pseudo-element{color:#a5e844}.token.punctuation{color:#89ddff}.token.regex{color:#f2ff00}.token.selector{color:#f66}.token.string{color:#a5e844}.token.symbol{color:#c792ea}.token.tag{color:#f66}.token.unit{color:#fd9170}.token.url,.token.variable{color:#f66}pre[class*=language-].line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}pre[class*=language-].line-numbers>code{position:relative;white-space:inherit}.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:0;font-size:100%;left:-3.8em;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-ms-user-select:none;user-select:none}.line-numbers-rows>span{display:block;counter-increment:linenumber}.line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}h1{font-size:1.5rem;font-weight:400;line-height:1.34;letter-spacing:0;margin-top:1em}h1,h2{font-family:Roboto,Helvetica,Arial,sans-serif;margin-bottom:.6em}h2{font-size:1.25rem;font-weight:500;line-height:1.6;letter-spacing:.0075rem;margin-top:.9em}h3{font-family:Roboto,Helvetica,Arial,sans-serif;font-size:.875rem;font-weight:600;line-height:1.58;letter-spacing:.00714rem;margin-top:.8em;margin-bottom:.6em}caption{font-size:.75rem;line-height:1.67;letter-spacing:.03333rem;margin:0}caption,p{font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400}p{margin-top:.4em;margin-bottom:.74em}li,p{font-size:.875rem;line-height:1.5;letter-spacing:.01786rem}li{font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;margin:8px 0 0}blockquote{margin:0 0 16px;padding:16px;border-left:5px solid #ff9800;background-color:#272822;color:#fff}a{color:#ff9800}.gatsby-highlight{background-color:#272822;border-radius:.4em;margin:1.4em 0;padding:1em;overflow:auto}.gatsby-highlight pre[class*=language-].line-numbers{padding:0 0 0 2.8em;overflow:initial}.gatsby-highlight-code-line{background-color:#000;display:block;margin-right:-1em;margin-left:-1em;padding-right:1em;padding-left:.75em;border-left:.25em solid #111}</style><meta name="generator" content="Gatsby 2.32.3"/><title data-react-helmet="true">Henrik Grönvall Consulting AB - Domain Driven Design - Entity and Value objects</title><link data-react-helmet="true" href="https://fonts.googleapis.com/css?family=Roboto:400,500,700&amp;display=swap" rel="stylesheet"/><meta data-react-helmet="true" name="description" content="A small peek into how DDD can help you focus on the right thing. When I used to start a new Node.js project, I usually started with analyzing and modelling the…"/><meta data-react-helmet="true" name="keywords" content="JavaScript,React,Node.js,HTML,CSS,Cloud"/><style id="jss-server-side">.jss4{padding-top:16px;padding-bottom:16px}.jss5{padding-top:16px;padding-left:16px;padding-right:16px;padding-bottom:16px}.jss6{padding-top:8px;padding-bottom:8px}.MuiTypography-root{margin:0}.MuiTypography-body2{font-size:.875rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.43;letter-spacing:.01071em}.MuiTypography-body1{font-size:1rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.5;letter-spacing:.00938em}.MuiTypography-caption{font-size:.75rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.66;letter-spacing:.03333em}.MuiTypography-button{font-size:.875rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:500;line-height:1.75;letter-spacing:.02857em;text-transform:uppercase}.MuiTypography-h1{font-size:6rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:300;line-height:1.167;letter-spacing:-.01562em}.MuiTypography-h2{font-size:3.75rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:300;line-height:1.2;letter-spacing:-.00833em}.MuiTypography-h3{font-size:3rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.167;letter-spacing:0}.MuiTypography-h4{font-size:2.125rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.235;letter-spacing:.00735em}.MuiTypography-h5{font-size:1.5rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.334;letter-spacing:0}.MuiTypography-h6{font-size:1.25rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:500;line-height:1.6;letter-spacing:.0075em}.MuiTypography-subtitle1{font-size:1rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:1.75;letter-spacing:.00938em}.MuiTypography-subtitle2{font-size:.875rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:500;line-height:1.57;letter-spacing:.00714em}.MuiTypography-overline{font-size:.75rem;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:400;line-height:2.66;letter-spacing:.08333em;text-transform:uppercase}.MuiTypography-srOnly{width:1px;height:1px;overflow:hidden;position:absolute}.MuiTypography-alignLeft{text-align:left}.MuiTypography-alignCenter{text-align:center}.MuiTypography-alignRight{text-align:right}.MuiTypography-alignJustify{text-align:justify}.MuiTypography-noWrap{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.MuiTypography-gutterBottom{margin-bottom:.35em}.MuiTypography-paragraph{margin-bottom:16px}.MuiTypography-colorInherit{color:inherit}.MuiTypography-colorPrimary{color:#3f51b5}.MuiTypography-colorSecondary{color:#f50057}.MuiTypography-colorTextPrimary{color:rgba(0,0,0,.87)}.MuiTypography-colorTextSecondary{color:rgba(0,0,0,.54)}.MuiTypography-colorError{color:#f44336}.MuiTypography-displayInline{display:inline}.MuiTypography-displayBlock{display:block}.MuiPaper-root{color:rgba(0,0,0,.87);transition:box-shadow .3s cubic-bezier(.4,0,.2,1) 0s;background-color:#fff}.MuiPaper-rounded{border-radius:4px}.MuiPaper-outlined{border:1px solid rgba(0,0,0,.12)}.MuiPaper-elevation0{box-shadow:none}.MuiPaper-elevation1{box-shadow:0 2px 1px -1px rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 1px 3px 0 rgba(0,0,0,.12)}.MuiPaper-elevation2{box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12)}.MuiPaper-elevation3{box-shadow:0 3px 3px -2px rgba(0,0,0,.2),0 3px 4px 0 rgba(0,0,0,.14),0 1px 8px 0 rgba(0,0,0,.12)}.MuiPaper-elevation4{box-shadow:0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12)}.MuiPaper-elevation5{box-shadow:0 3px 5px -1px rgba(0,0,0,.2),0 5px 8px 0 rgba(0,0,0,.14),0 1px 14px 0 rgba(0,0,0,.12)}.MuiPaper-elevation6{box-shadow:0 3px 5px -1px rgba(0,0,0,.2),0 6px 10px 0 rgba(0,0,0,.14),0 1px 18px 0 rgba(0,0,0,.12)}.MuiPaper-elevation7{box-shadow:0 4px 5px -2px rgba(0,0,0,.2),0 7px 10px 1px rgba(0,0,0,.14),0 2px 16px 1px rgba(0,0,0,.12)}.MuiPaper-elevation8{box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.MuiPaper-elevation9{box-shadow:0 5px 6px -3px rgba(0,0,0,.2),0 9px 12px 1px rgba(0,0,0,.14),0 3px 16px 2px rgba(0,0,0,.12)}.MuiPaper-elevation10{box-shadow:0 6px 6px -3px rgba(0,0,0,.2),0 10px 14px 1px rgba(0,0,0,.14),0 4px 18px 3px rgba(0,0,0,.12)}.MuiPaper-elevation11{box-shadow:0 6px 7px -4px rgba(0,0,0,.2),0 11px 15px 1px rgba(0,0,0,.14),0 4px 20px 3px rgba(0,0,0,.12)}.MuiPaper-elevation12{box-shadow:0 7px 8px -4px rgba(0,0,0,.2),0 12px 17px 2px rgba(0,0,0,.14),0 5px 22px 4px rgba(0,0,0,.12)}.MuiPaper-elevation13{box-shadow:0 7px 8px -4px rgba(0,0,0,.2),0 13px 19px 2px rgba(0,0,0,.14),0 5px 24px 4px rgba(0,0,0,.12)}.MuiPaper-elevation14{box-shadow:0 7px 9px -4px rgba(0,0,0,.2),0 14px 21px 2px rgba(0,0,0,.14),0 5px 26px 4px rgba(0,0,0,.12)}.MuiPaper-elevation15{box-shadow:0 8px 9px -5px rgba(0,0,0,.2),0 15px 22px 2px rgba(0,0,0,.14),0 6px 28px 5px rgba(0,0,0,.12)}.MuiPaper-elevation16{box-shadow:0 8px 10px -5px rgba(0,0,0,.2),0 16px 24px 2px rgba(0,0,0,.14),0 6px 30px 5px rgba(0,0,0,.12)}.MuiPaper-elevation17{box-shadow:0 8px 11px -5px rgba(0,0,0,.2),0 17px 26px 2px rgba(0,0,0,.14),0 6px 32px 5px rgba(0,0,0,.12)}.MuiPaper-elevation18{box-shadow:0 9px 11px -5px rgba(0,0,0,.2),0 18px 28px 2px rgba(0,0,0,.14),0 7px 34px 6px rgba(0,0,0,.12)}.MuiPaper-elevation19{box-shadow:0 9px 12px -6px rgba(0,0,0,.2),0 19px 29px 2px rgba(0,0,0,.14),0 7px 36px 6px rgba(0,0,0,.12)}.MuiPaper-elevation20{box-shadow:0 10px 13px -6px rgba(0,0,0,.2),0 20px 31px 3px rgba(0,0,0,.14),0 8px 38px 7px rgba(0,0,0,.12)}.MuiPaper-elevation21{box-shadow:0 10px 13px -6px rgba(0,0,0,.2),0 21px 33px 3px rgba(0,0,0,.14),0 8px 40px 7px rgba(0,0,0,.12)}.MuiPaper-elevation22{box-shadow:0 10px 14px -6px rgba(0,0,0,.2),0 22px 35px 3px rgba(0,0,0,.14),0 8px 42px 7px rgba(0,0,0,.12)}.MuiPaper-elevation23{box-shadow:0 11px 14px -7px rgba(0,0,0,.2),0 23px 36px 3px rgba(0,0,0,.14),0 9px 44px 8px rgba(0,0,0,.12)}.MuiPaper-elevation24{box-shadow:0 11px 15px -7px rgba(0,0,0,.2),0 24px 38px 3px rgba(0,0,0,.14),0 9px 46px 8px rgba(0,0,0,.12)}.MuiAppBar-root{width:100%;display:flex;z-index:1100;box-sizing:border-box;flex-shrink:0;flex-direction:column}.MuiAppBar-positionFixed{top:0;left:auto;right:0;position:fixed}@media print{.MuiAppBar-positionFixed{position:absolute}}.MuiAppBar-positionAbsolute{top:0;left:auto;right:0;position:absolute}.MuiAppBar-positionSticky{top:0;left:auto;right:0;position:-webkit-sticky;position:sticky}.MuiAppBar-positionStatic{position:static}.MuiAppBar-positionRelative{position:relative}.MuiAppBar-colorDefault{color:rgba(0,0,0,.87);background-color:#f5f5f5}.MuiAppBar-colorPrimary{color:#fff;background-color:#3f51b5}.MuiAppBar-colorSecondary{color:#fff;background-color:#f50057}.MuiAppBar-colorInherit{color:inherit}.MuiAppBar-colorTransparent{color:inherit;background-color:transparent}.MuiToolbar-root{display:flex;position:relative;align-items:center}.MuiToolbar-gutters{padding-left:16px;padding-right:16px}@media (min-width:600px){.MuiToolbar-gutters{padding-left:24px;padding-right:24px}}.MuiToolbar-regular{min-height:56px}@media (min-width:0px) and (orientation:landscape){.MuiToolbar-regular{min-height:48px}}@media (min-width:600px){.MuiToolbar-regular{min-height:64px}}.MuiToolbar-dense{min-height:48px}.MuiButtonBase-root{color:inherit;border:0;cursor:pointer;margin:0;display:inline-flex;outline:0;padding:0;position:relative;align-items:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border-radius:0;vertical-align:middle;-moz-appearance:none;justify-content:center;text-decoration:none;background-color:transparent;-webkit-appearance:none;-webkit-tap-highlight-color:transparent}.MuiButtonBase-root::-moz-focus-inner{border-style:none}.MuiButtonBase-root.Mui-disabled{cursor:default;pointer-events:none}@media print{.MuiButtonBase-root{-webkit-print-color-adjust:exact;color-adjust:exact}}.MuiIconButton-root{flex:0 0 auto;color:rgba(0,0,0,.54);padding:12px;overflow:visible;font-size:1.5rem;text-align:center;transition:background-color 150ms cubic-bezier(.4,0,.2,1) 0s;border-radius:50%}.MuiIconButton-root:hover{background-color:rgba(0,0,0,.04)}.MuiIconButton-root.Mui-disabled{color:rgba(0,0,0,.26);background-color:transparent}@media (hover:none){.MuiIconButton-root:hover{background-color:transparent}}.MuiIconButton-edgeStart{margin-left:-12px}.MuiIconButton-sizeSmall.MuiIconButton-edgeStart{margin-left:-3px}.MuiIconButton-edgeEnd{margin-right:-12px}.MuiIconButton-sizeSmall.MuiIconButton-edgeEnd{margin-right:-3px}.MuiIconButton-colorInherit{color:inherit}.MuiIconButton-colorPrimary{color:#3f51b5}.MuiIconButton-colorPrimary:hover{background-color:rgba(63,81,181,.04)}@media (hover:none){.MuiIconButton-colorPrimary:hover{background-color:transparent}}.MuiIconButton-colorSecondary{color:#f50057}.MuiIconButton-colorSecondary:hover{background-color:rgba(245,0,87,.04)}@media (hover:none){.MuiIconButton-colorSecondary:hover{background-color:transparent}}.MuiIconButton-sizeSmall{padding:3px;font-size:1.125rem}.MuiIconButton-label{width:100%;display:flex;align-items:inherit;justify-content:inherit}.MuiSvgIcon-root{fill:currentColor;width:1em;height:1em;display:inline-block;font-size:1.5rem;transition:fill .2s cubic-bezier(.4,0,.2,1) 0s;flex-shrink:0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.MuiSvgIcon-colorPrimary{color:#3f51b5}.MuiSvgIcon-colorSecondary{color:#f50057}.MuiSvgIcon-colorAction{color:rgba(0,0,0,.54)}.MuiSvgIcon-colorError{color:#f44336}.MuiSvgIcon-colorDisabled{color:rgba(0,0,0,.26)}.MuiSvgIcon-fontSizeInherit{font-size:inherit}.MuiSvgIcon-fontSizeSmall{font-size:1.25rem}.MuiSvgIcon-fontSizeLarge{font-size:2.1875rem}.MuiLink-underlineNone{text-decoration:none}.MuiLink-underlineHover{text-decoration:none}.MuiLink-underlineHover:hover{text-decoration:underline}.MuiLink-underlineAlways{text-decoration:underline}.MuiLink-button{border:0;cursor:pointer;margin:0;outline:0;padding:0;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border-radius:0;vertical-align:middle;-moz-appearance:none;background-color:transparent;-webkit-appearance:none;-webkit-tap-highlight-color:transparent}.MuiLink-button::-moz-focus-inner{border-style:none}.MuiLink-button.Mui-focusVisible{outline:auto}.MuiFab-root{color:rgba(0,0,0,.87);width:56px;height:56px;padding:0;font-size:.875rem;min-width:0;box-shadow:0 3px 5px -1px rgba(0,0,0,.2),0 6px 10px 0 rgba(0,0,0,.14),0 1px 18px 0 rgba(0,0,0,.12);box-sizing:border-box;min-height:36px;transition:background-color 250ms cubic-bezier(.4,0,.2,1) 0s,box-shadow 250ms cubic-bezier(.4,0,.2,1) 0s,border 250ms cubic-bezier(.4,0,.2,1) 0s;font-family:Roboto,Helvetica,Arial,sans-serif;font-weight:500;line-height:1.75;border-radius:50%;letter-spacing:.02857em;text-transform:uppercase;background-color:#e0e0e0}.MuiFab-root:active{box-shadow:0 7px 8px -4px rgba(0,0,0,.2),0 12px 17px 2px rgba(0,0,0,.14),0 5px 22px 4px rgba(0,0,0,.12)}.MuiFab-root:hover{text-decoration:none;background-color:#d5d5d5}.MuiFab-root.Mui-focusVisible{box-shadow:0 3px 5px -1px rgba(0,0,0,.2),0 6px 10px 0 rgba(0,0,0,.14),0 1px 18px 0 rgba(0,0,0,.12)}.MuiFab-root.Mui-disabled{color:rgba(0,0,0,.26);box-shadow:none;background-color:rgba(0,0,0,.12)}@media (hover:none){.MuiFab-root:hover{background-color:#e0e0e0}}.MuiFab-root:hover.Mui-disabled{background-color:rgba(0,0,0,.12)}.MuiFab-label{width:100%;display:inherit;align-items:inherit;justify-content:inherit}.MuiFab-primary{color:#fff;background-color:#3f51b5}.MuiFab-primary:hover{background-color:#303f9f}@media (hover:none){.MuiFab-primary:hover{background-color:#3f51b5}}.MuiFab-secondary{color:#fff;background-color:#f50057}.MuiFab-secondary:hover{background-color:#c51162}@media (hover:none){.MuiFab-secondary:hover{background-color:#f50057}}.MuiFab-extended{width:auto;height:48px;padding:0 16px;min-width:48px;min-height:auto;border-radius:24px}.MuiFab-extended.MuiFab-sizeSmall{width:auto;height:34px;padding:0 8px;min-width:34px;border-radius:17px}.MuiFab-extended.MuiFab-sizeMedium{width:auto;height:40px;padding:0 16px;min-width:40px;border-radius:20px}.MuiFab-colorInherit{color:inherit}.MuiFab-sizeSmall{width:40px;height:40px}.MuiFab-sizeMedium{width:48px;height:48px}.MuiContainer-root{width:100%;display:block;box-sizing:border-box;margin-left:auto;margin-right:auto;padding-left:16px;padding-right:16px}@media (min-width:600px){.MuiContainer-root{padding-left:24px;padding-right:24px}}.MuiContainer-disableGutters{padding-left:0;padding-right:0}@media (min-width:600px){.MuiContainer-fixed{max-width:600px}}@media (min-width:960px){.MuiContainer-fixed{max-width:960px}}@media (min-width:1280px){.MuiContainer-fixed{max-width:1280px}}@media (min-width:1920px){.MuiContainer-fixed{max-width:1920px}}@media (min-width:0px){.MuiContainer-maxWidthXs{max-width:444px}}@media (min-width:600px){.MuiContainer-maxWidthSm{max-width:600px}}@media (min-width:960px){.MuiContainer-maxWidthMd{max-width:960px}}@media (min-width:1280px){.MuiContainer-maxWidthLg{max-width:1280px}}@media (min-width:1920px){.MuiContainer-maxWidthXl{max-width:1920px}}.MuiCard-root{overflow:hidden}.jss12{right:16px;bottom:16px;position:fixed}.jss10{color:#fff;background-color:#3f51b5}.jss11{color:#fff;background-color:#3f51b5}.jss7{color:#fff;padding:48px 16px;margin-top:64px;background-color:#3f51b5}.MuiDivider-root{border:none;height:1px;margin:0;flex-shrink:0;background-color:rgba(0,0,0,.12)}.MuiDivider-absolute{left:0;width:100%;bottom:0;position:absolute}.MuiDivider-inset{margin-left:72px}.MuiDivider-light{background-color:rgba(0,0,0,.08)}.MuiDivider-middle{margin-left:16px;margin-right:16px}.MuiDivider-vertical{width:1px;height:100%}.MuiDivider-flexItem{height:auto;align-self:stretch}.MuiCardMedia-root{display:block;background-size:cover;background-repeat:no-repeat;background-position:center}.MuiCardMedia-media{width:100%}.MuiCardMedia-img{-o-object-fit:cover;object-fit:cover}.jss1{height:210px}.jss2{font-size:14px;padding-top:16px}.jss3{font-size:14px}</style><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><link as="script" rel="preload" href="/webpack-runtime-91dba61c592503c75764.js"/><link as="script" rel="preload" href="/framework-fc1db31f678bd7aa66d8.js"/><link as="script" rel="preload" href="/app-dab37efb0e80ffc19c48.js"/><link as="script" rel="preload" href="/styles-474c0340beb1ced255f1.js"/><link as="script" rel="preload" href="/commons-1fa1cc8db38767895567.js"/><link as="script" rel="preload" href="/875d5575f84d2db311b8feddedb7ed30b8fce884-a10e62bc32fef4276a77.js"/><link as="script" rel="preload" href="/component---src-templates-article-page-template-js-739aff28fbb06e961f1a.js"/><link as="fetch" rel="preload" href="/page-data\articles\ddd-lessons-learned\page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/4011214723.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data\app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><header class="MuiPaper-root MuiAppBar-root MuiAppBar-positionFixed MuiAppBar-colorPrimary mui-fixed MuiPaper-elevation0"><div class="MuiToolbar-root MuiToolbar-regular MuiToolbar-gutters"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorInherit MuiIconButton-edgeStart" tabindex="0" type="button" aria-label="menu"><span class="MuiIconButton-label"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg></span></button><h6 class="MuiTypography-root MuiTypography-subtitle1 MuiTypography-colorInherit">Domain Driven Design - Entity and Value objects</h6></div></header><div class="MuiToolbar-root MuiToolbar-regular MuiToolbar-gutters" id="back-to-top-anchor"></div><div class="MuiContainer-root MuiBox-root jss4 MuiContainer-maxWidthMd"><div class="MuiPaper-root MuiCard-root MuiPaper-elevation1 MuiPaper-rounded"><div class="MuiCardMedia-root jss1" style="background-image:url(&quot;https://source.unsplash.com/random?summer&quot;)"></div><div class="MuiBox-root jss5"><div><h1>A small peek into how DDD can help you focus on the right thing.</h1>
<p>When I used to start a new Node.js project, I usually started with analyzing and modelling the RESTful API and
possible the database schemas and models. This means I would mock the data and wire up som basic route
handlers, controllers, for different RESTful endpoints to ultimately test them with Postman. </p>
<p>In other words, I was building my app from the database, or the RESTFul API up and thinking CRUD first.
If you have read the <a href="https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html">Clean Architecture</a>,
by Uncle Bob, you know you should never put business logic in the Controllers and that's exactly what
this approach to starting lead to.</p>
<p>An example of a controller when using this approach could look like this.</p>
<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber NaN" class="language-javascript line-numbers"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">MovieController</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> models
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">models</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>models <span class="token operator">=</span> models
  <span class="token punctuation">}</span>
  <span class="token keyword">private</span> <span class="token function">notFound</span><span class="token punctuation">(</span><span class="token parameter">response<span class="token punctuation">,</span> message</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">private</span> <span class="token function">ok</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  
  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">rentMovie</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> movieId<span class="token punctuation">,</span> customerId <span class="token punctuation">}</span> <span class="token operator">=</span> request
    <span class="token comment">// ORM models</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> Movie<span class="token punctuation">,</span> Customer<span class="token punctuation">,</span> RentedMovie<span class="token punctuation">,</span> CustomerCharge <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>models<span class="token punctuation">;</span>

    <span class="token comment">// Get the raw orm records, as JSON</span>
    <span class="token keyword">const</span> movie <span class="token operator">=</span> <span class="token keyword">await</span> Movie<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> movie_id<span class="token operator">:</span> movieId <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> customer <span class="token operator">=</span> <span class="token keyword">await</span> Customer<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> customer_id<span class="token operator">:</span> customerId <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 401 error if not found</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>movie<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">notFound</span><span class="token punctuation">(</span>response<span class="token punctuation">,</span> <span class="token string">'Movie not found'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 401 error if not found</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>customer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">notFound</span><span class="token punctuation">(</span>response<span class="token punctuation">,</span> <span class="token string">'Customer not found'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Create a record that a movie was rented</span>
    <span class="token keyword">await</span> RentedMovie<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span> customer_id<span class="token operator">:</span> customerId<span class="token punctuation">,</span> movie_id<span class="token operator">:</span> movieId <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Create a charge for this customer.</span>
    <span class="token keyword">await</span> CustomerCharge<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span> amount<span class="token operator">:</span> movie<span class="token punctuation">.</span>rentPrice <span class="token punctuation">}</span><span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>This is quick approach and could get into trouble as soon changes in the business rules are required.</p>
<h2>Business rules in CRUD first code</h2>
<p>Let's say we need to apply the business rules; The customer should not be able to rent a
video if they;</p>
<ul>
<li>have rented the maximum amount of movies at one time,</li>
<li>have unpaid balances.</li>
</ul>
<p>An implementation of this in the controller could then look like this.</p>
<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber NaN" class="language-javascript line-numbers"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">MovieController</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> models
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">models</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>models <span class="token operator">=</span> models
  <span class="token punctuation">}</span>
  <span class="token keyword">private</span> <span class="token function">notFound</span><span class="token punctuation">(</span><span class="token parameter">response<span class="token punctuation">,</span> message</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">private</span> <span class="token function">fail</span><span class="token punctuation">(</span><span class="token parameter">response<span class="token punctuation">,</span> message</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">private</span> <span class="token function">ok</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">rentMovie</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> movieId<span class="token punctuation">,</span> customerId <span class="token punctuation">}</span> <span class="token operator">=</span> request
    
    <span class="token comment">// We need to add another model - CustomerPayment </span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> 
      Movie<span class="token punctuation">,</span> 
      Customer<span class="token punctuation">,</span> 
      RentedMovie<span class="token punctuation">,</span> 
      CustomerCharge<span class="token punctuation">,</span>
      CustomerPayment
    <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>models<span class="token punctuation">;</span>

    <span class="token keyword">const</span> movie <span class="token operator">=</span> <span class="token keyword">await</span> Movie<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> movie_id<span class="token operator">:</span> movieId <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> customer <span class="token operator">=</span> <span class="token keyword">await</span> Customer<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> customer_id<span class="token operator">:</span> customerId <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>movie<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">notFound</span><span class="token punctuation">(</span>response<span class="token punctuation">,</span> <span class="token string">'Movie not found'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>customer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">notFound</span><span class="token punctuation">(</span>response<span class="token punctuation">,</span> <span class="token string">'Customer not found'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// Get the number of movies that this user has rented</span>
    <span class="token keyword">const</span> rentedMovies <span class="token operator">=</span> <span class="token keyword">await</span> RentedMovie<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span> customer_id<span class="token operator">:</span> customerId <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> numberRentedMovies <span class="token operator">=</span> rentedMovies<span class="token punctuation">.</span>length<span class="token punctuation">;</span>

    <span class="token comment">// Enforce the rule</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>numberRentedMovies <span class="token operator">>=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span><span class="token string">'Customer already has the maxiumum number of rented movies'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Get all the charges and payments so that we can </span>
    <span class="token comment">// determine if the user still owes money</span>
    <span class="token keyword">const</span> charges <span class="token operator">=</span> <span class="token keyword">await</span> CustomerCharge<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span> customer_id<span class="token operator">:</span> customerId <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> payments <span class="token operator">=</span> <span class="token keyword">await</span> CustomerPayment<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span> customer_id<span class="token operator">:</span> customerId <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> chargeDollars <span class="token operator">=</span> charges<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">previousCharge<span class="token punctuation">,</span> nextCharge</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> previousCharge<span class="token punctuation">.</span>amount <span class="token operator">+</span> nextCharge<span class="token punctuation">.</span>amount<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> paymentDollars <span class="token operator">=</span> payments<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">previousPayment<span class="token punctuation">,</span> nextPayment</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> previousPayment<span class="token punctuation">.</span>amount <span class="token operator">+</span> nextPayment<span class="token punctuation">.</span>amount<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// Enforce the second business rule</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>chargeDollars <span class="token operator">></span> paymentDollars<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span><span class="token string">'Customer has outstanding balance unpaid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Create a record that a movie was rented</span>
    <span class="token keyword">await</span> RentedMovie<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span> customer_id<span class="token operator">:</span> customerId<span class="token punctuation">,</span> movie_id<span class="token operator">:</span> movieId <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Create a charge for this customer.</span>
    <span class="token keyword">await</span> CustomerCharge<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span> amount<span class="token operator">:</span> movie<span class="token punctuation">.</span>rentPrice <span class="token punctuation">}</span><span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>This solution works for CRUD design first approach, but there are drawbacks.</p>
<h2>Encapsulation</h2>
<p>If the complexity of our business model grows, we could move the domain logic to the service
but, it is just to re-locate the same logic somewhere else and by doing so, we will risk ending
up with an anemic domain model.</p>
<blockquote>
<p>Wikipedia says an Anemic Domain Model "is the use of a software domain model where the domain objects
contain little or no business logic (validations, calculations, business rules etc.)"</p>
</blockquote>
<p>In other words. When the classes that describe the models (movie and customer), and the classes
that perform operations on the model are separate we enter the anemic model land. The services contain
all the domain logic while the domain objects themselves contain practically none.</p>
<blockquote>
<p>Anemic Domain Models are largely the cause of a lack of encapsulation and isolation.</p>
</blockquote>
<h2>Discoverability</h2>
<p>When you look at a class, and it’s methods for the first time, it should accurately describe to you the
capabilities and limitations of that class. When we co-locate the capabilities and rules of the Customer
to an infrastructure concern (controllers), we lose some of that discoverability for what a Customer can
do and when it’s allowed to do it.</p>
<h2>CRUD design is a transaction script approach</h2>
<p>According to Martin Fowler, the CRUD design approach sound to me that it is a transaction script approach.</p>
<p>See: <a href="https://martinfowler.com/eaaCatalog/transactionScript.html">Transaction Script</a></p>
<h2>The case for DDD and domain model first</h2>
<p>In DDD, we can from a declarative perspective, design the business rules that answer what and when
something can be done which make it much more readable, flexible and expressive.</p>
<p>If we were to take our previous example and using DDD, the controller code would probably look
something like this:</p>
<div class="gatsby-highlight" data-language="javascript"><pre style="counter-reset: linenumber NaN" class="language-javascript line-numbers"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">MovieController</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> movieRepo<span class="token operator">:</span> IMovieRepo<span class="token punctuation">;</span>
  <span class="token keyword">private</span> customerRepo<span class="token operator">:</span> ICustomerRepo<span class="token punctuation">;</span>
  <span class="token function">constructor</span> <span class="token punctuation">(</span><span class="token parameter">movieRepo<span class="token operator">:</span> IMovieRepo<span class="token punctuation">,</span> customerRepo<span class="token operator">:</span> ICustomerRepo</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>movieRepo <span class="token operator">=</span> movieRepo<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>customerRepo <span class="token operator">=</span> customerRepo<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token function">rentMovie</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> movieId<span class="token punctuation">,</span> customerId <span class="token punctuation">}</span> <span class="token operator">=</span> request
    
    <span class="token keyword">const</span> movie<span class="token operator">:</span> Movie <span class="token operator">=</span> <span class="token keyword">await</span> movieRepo<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>movieId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> customer<span class="token operator">:</span> Customer <span class="token operator">=</span> <span class="token keyword">await</span> customerRepo<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>customerId<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>movie<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span><span class="token string">'Movie not found'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>customer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span><span class="token string">'Customer not found'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//</span>
    <span class="token comment">// The declarative magic happens here.</span>
    <span class="token comment">//</span>
    <span class="token keyword">const</span> rentMovieResult<span class="token operator">:</span> Result<span class="token operator">&lt;</span>Customer<span class="token operator">></span> <span class="token operator">=</span> customer<span class="token punctuation">.</span><span class="token function">rentMovie</span><span class="token punctuation">(</span>movie<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>rentMovieResult<span class="token punctuation">.</span>isFailure<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span>rentMovieResult<span class="token punctuation">.</span>error<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">await</span> customerRepo<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>So what is the difference? The controller does not implement any business rules, instead,
enforcing of the business rules are now implemented in the movie and customer objects. The movie
and the customer objects are entity objects, created by the repository and mappers. I will write about repositories
and mappers in future articles. That's why the method rentMovie, in the entity object customer, can perform it's magic,
it knows about what and when it can rent a video. </p>
<p>When model the domain logic we want to express what it;</p>
<ul>
<li>can do,</li>
<li>when it can do it, and</li>
<li>what conditions dictate when it can do that thing.</li>
</ul>
<p>That also means we are enforcing model invariants, which is the same as ensuring the data integrity
of an object and, by ensuring data integrity, we mean;</p>
<ul>
<li>what shape is this data allowed to take,</li>
<li>what methods can be called and when,</li>
<li>what are the required parameters and pre-conditions in order to create this object.</li>
</ul>
<p>A business object methods need to preserve the invariants of an object and to constrain the state stored
in the object to protect the model from corruption. </p>
<h2>Entity objects</h2>
<p>In DDD, to model the domain logic, we are using entities (or value objects), and implements the business logic.
Entity objects are different to value objects and are characterized by;</p>
<ul>
<li>have a lifespan, a history of what happened to them and how they changed,</li>
<li>they are mutable, their internal state can change during their lifespan,</li>
<li>have their own intrinsic identity, which refers to a unique id, if data in two entity instances
is the same (except for the id property), we don’t deem them as equivalent.</li>
</ul>
<p>When coding in Typescript and Node.js, I have created an abstract Entity class that I inherit from
when I model my domain entity classes that fulfill the characteristics of an entity object.</p>
<p>Here is my current implementation of the abstract Entity class.</p>
<div class="gatsby-highlight" data-language="typescript"><pre style="counter-reset: linenumber NaN" class="language-typescript line-numbers"><code class="language-typescript"><span class="token comment">// A class generating unique id</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UniqueEntityID <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./UniqueEntityID'</span>

<span class="token comment">/**
 * Entity type comparator
 * @param v
 */</span>
<span class="token keyword">const</span> isEntity <span class="token operator">=</span> <span class="token punctuation">(</span>v<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token operator">:</span> v <span class="token keyword">is</span> Entity<span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">></span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> v <span class="token keyword">instanceof</span> <span class="token class-name">Entity</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * Entity class implementation
 * Use Entity to entities to enforce model invariants
 * @class
 */</span>
<span class="token keyword">export</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Entity<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span></span> <span class="token punctuation">{</span>
  <span class="token comment">/**
   * The id of the entity and it's readonly since it
   * should not be able to change after instantiated
   */</span>
  <span class="token keyword">protected</span> <span class="token keyword">readonly</span> _id<span class="token operator">:</span> UniqueEntityID
  <span class="token comment">/**
   * The props of the entity class are stored in this.props
   * to leave to the subclass to decide getters and setters
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">readonly</span> props<span class="token operator">:</span> <span class="token constant">T</span>

  <span class="token comment">/**
   * Creates a new Entity instance
   * @param props
   * @param id
   */</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span>props<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">,</span> id<span class="token operator">?</span><span class="token operator">:</span> UniqueEntityID<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_id <span class="token operator">=</span> id <span class="token operator">?</span> id <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">UniqueEntityID</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>props <span class="token operator">=</span> props
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * Equal comparator based on Identifier equality
   * @param object
   */</span>
  <span class="token keyword">public</span> <span class="token function">equals</span><span class="token punctuation">(</span>object<span class="token operator">?</span><span class="token operator">:</span> Entity<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>object <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">===</span> object<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isEntity</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_id<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>object<span class="token punctuation">.</span>_id<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>Value objects</h2>
<p>Value objects are more used in DDD, and their characteristics are;</p>
<ul>
<li>they do not have a lifespan,</li>
<li>they can not live by their own, they should belong to an Entity object,</li>
<li>they can not be persisted on their own, they are persisted by their entities they belong to,</li>
<li>they do not have an id, they are equal by their attributes (value),</li>
<li>they are immutable, and thus representing a snapshot of the state.</li>
</ul>
<p>Here is my current implementation of the abstract ValueObject class.</p>
<div class="gatsby-highlight" data-language="typescript"><pre style="counter-reset: linenumber NaN" class="language-typescript line-numbers"><code class="language-typescript"><span class="token comment">/**
 * Value object properties interface
 */</span>
<span class="token keyword">interface</span> <span class="token class-name">IValueObjectProps</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>index<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">any</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * Abstract class implements value objects
 * @class
 */</span>
<span class="token keyword">export</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">ValueObject<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> IValueObjectProps<span class="token operator">></span></span> <span class="token punctuation">{</span>
  <span class="token comment">/**
   * The props of the value object are stored in this.props
   * to leave to the subclass to decide getters
   */</span>
  <span class="token keyword">public</span> props<span class="token operator">:</span> <span class="token constant">T</span>

  <span class="token comment">/**
   * Creates a new ValueObject instance
   * @param props
   */</span>
  <span class="token keyword">protected</span> <span class="token keyword">constructor</span><span class="token punctuation">(</span>props<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>props <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span>props<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * Equality comparator for value objects
   * @param vo
   */</span>
  <span class="token keyword">public</span> <span class="token function">equals</span><span class="token punctuation">(</span>vo<span class="token operator">?</span><span class="token operator">:</span> ValueObject<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>vo <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">||</span> vo <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>vo<span class="token punctuation">.</span>props <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>vo<span class="token punctuation">.</span>props<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>How to recognize a value object in your domain model?</h2>
<p>It's not easy at first to know if a business object should be implemented as an Entity or, as a
Value object, but the notion of an identity is helpful and could be a first guideline.</p>
<blockquote>
<p>Ask yourself if you can safely replace an instance class with another with the same attributes, if so,
it should probably be a value object. </p>
</blockquote>
<h2>Summary</h2>
<p>Domain-Driven Design is an approach to software development that centers the development on programming
a domain model that has a rich understanding of the processes and rules of a domain. It is a natural starting
point for any project to start to evaluate the business logic. You focus from the get going on what should be
done, when it should be done and so on instead of focus on infrastructure concerns.</p>
<p>I have tried to describe that separation of concerns, single responsibility principles and, a clean architecture
really matters and are important even if you need to get something up and running quickly, you want to respond
to prototype apps, you are working on a small app, etc. </p>
<p>I wrote in my previous article about the importance of the Ubiquitous Language and its role to understand and evaluate
the business model. This language should be based on the Domain Model used in the software - hence the need for it to
be rigorous, since software doesn't cope well with ambiguity.</p>
<p>In a future article I will cover another important aspect of DDD, use cases to describe the actors in a
business model and probably share more code that will include entity and value objects.</p>
<p>References:</p>
<ul>
<li>Martin Fowler: <a href="https://www.martinfowler.com/bliki/AnemicDomainModel.html">Anemic Domain Model</a></li>
<li>Uncle Bob: <a href="https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html">Clean Architecture</a></li>
</ul></div><div class="MuiBox-root jss6"><hr class="MuiDivider-root"/></div><h6 class="MuiTypography-root MuiTypography-subtitle2 MuiTypography-colorTextSecondary">Published: <!-- -->2021-02-23</h6><h6 class="MuiTypography-root MuiTypography-subtitle2 MuiTypography-colorTextSecondary">PublishedBy: <!-- -->Henrik Grönvall</h6></div></div></div><div class="MuiBox-root jss8 jss7"><h6 class="MuiTypography-root MuiTypography-subtitle2 MuiTypography-gutterBottom">Henrik Grönvall</h6><div class="MuiBox-root jss9"><a class="MuiTypography-root MuiLink-root MuiLink-underlineHover MuiButtonBase-root MuiIconButton-root jss10 MuiTypography-colorPrimary" tabindex="0" role="button" aria-disabled="false" aria-label="github" href="https://github.com/HenrikGr" target="_blank" rel="noopener noreferrer"><span class="MuiIconButton-label"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 .3a12 12 0 0 0-3.8 23.4c.6.1.8-.3.8-.6v-2c-3.3.7-4-1.6-4-1.6-.6-1.4-1.4-1.8-1.4-1.8-1-.7.1-.7.1-.7 1.2 0 1.9 1.2 1.9 1.2 1 1.8 2.8 1.3 3.5 1 0-.8.4-1.3.7-1.6-2.7-.3-5.5-1.3-5.5-6 0-1.2.5-2.3 1.3-3.1-.2-.4-.6-1.6 0-3.2 0 0 1-.3 3.4 1.2a11.5 11.5 0 0 1 6 0c2.3-1.5 3.3-1.2 3.3-1.2.6 1.6.2 2.8 0 3.2.9.8 1.3 1.9 1.3 3.2 0 4.6-2.8 5.6-5.5 5.9.5.4.9 1 .9 2.2v3.3c0 .3.1.7.8.6A12 12 0 0 0 12 .3"></path></svg></span></a><a class="MuiTypography-root MuiLink-root MuiLink-underlineHover MuiButtonBase-root MuiIconButton-root jss11 MuiTypography-colorPrimary" tabindex="0" role="button" aria-disabled="false" aria-label="email" href="mailto:hgc-ab@outlook.com" target="_blank" rel="noopener noreferrer"><span class="MuiIconButton-label"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"></path></svg></span></a></div><h6 class="MuiTypography-root MuiTypography-subtitle2 MuiTypography-alignRight">Copyright © <!-- -->2021<!-- --> <!-- -->Henrik Grönvall Consulting AB</h6></div><div role="presentation" class="jss12" style="transform:scale(0);visibility:hidden"><button class="MuiButtonBase-root MuiFab-root MuiFab-secondary" tabindex="0" type="button" aria-label="scroll back to top"><span class="MuiFab-label"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path></svg></span></button></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-152419885-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/articles/ddd-lessons-learned/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-9bc96f51ad3ffc5b0445.js"],"app":["/app-dab37efb0e80ffc19c48.js"],"component---src-pages-404-js":["/component---src-pages-404-js-2b4d843aa30523e2d675.js"],"component---src-pages-articles-js":["/component---src-pages-articles-js-0cfd1888984f7feb9bfc.js"],"component---src-pages-index-js":["/component---src-pages-index-js-560dad1eeeb37fe27e49.js"],"component---src-pages-projects-js":["/component---src-pages-projects-js-4390e6782f6bb150028e.js"],"component---src-templates-about-page-template-js":["/component---src-templates-about-page-template-js-abbcde3e6672b5fbca28.js"],"component---src-templates-article-page-template-js":["/component---src-templates-article-page-template-js-739aff28fbb06e961f1a.js"],"component---src-templates-articles-tags-template-js":["/component---src-templates-articles-tags-template-js-ae517f34a76594607cd8.js"],"component---src-templates-project-page-template-js":["/component---src-templates-project-page-template-js-5f0c1e34937f66560870.js"]};/*]]>*/</script><script src="/polyfill-9bc96f51ad3ffc5b0445.js" nomodule=""></script><script src="/component---src-templates-article-page-template-js-739aff28fbb06e961f1a.js" async=""></script><script src="/875d5575f84d2db311b8feddedb7ed30b8fce884-a10e62bc32fef4276a77.js" async=""></script><script src="/commons-1fa1cc8db38767895567.js" async=""></script><script src="/styles-474c0340beb1ced255f1.js" async=""></script><script src="/app-dab37efb0e80ffc19c48.js" async=""></script><script src="/framework-fc1db31f678bd7aa66d8.js" async=""></script><script src="/webpack-runtime-91dba61c592503c75764.js" async=""></script></body></html>