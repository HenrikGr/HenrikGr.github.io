{"componentChunkName":"component---src-templates-project-page-template-js","path":"/projects/ci-github-actions/","result":{"data":{"markdownRemark":{"frontmatter":{"title":"CI/CD with Github Actions","subtitle":"Create custom software development life cycle (SDLC) workflows directly in your GitHub repository","date":"2019-12-15","publishedBy":"Henrik Grönvall"},"excerpt":"Github Actions let us create custom software development life cycle (SDLC) workflows directly in your GitHub repository.\nWith GitHub Actions…","timeToRead":3,"html":"<p>Github Actions let us create custom software development life cycle (SDLC) workflows directly in your GitHub repository.\nWith GitHub Actions you can build end-to-end continuous integration (CI) and continuous deployment (CD) capabilities\ndirectly in your repository.</p>\n<h1>About Github Actions</h1>\n<p>GitHub Actions help you automate your software development workflows in the same place you store code and collaborate on\npull requests and issues. You can write individual tasks, called actions, and combine them to create a custom workflow.\nWorkflows are custom automated processes that you can set up in your repository to build, test, package, release, or\ndeploy any code project on GitHub.</p>\n<p>Workflows run in Linux, macOS, Windows, and containers on GitHub-hosted servers. You can create workflows using actions\ndefined in your repository, open source actions in a public repository on GitHub, or a published Docker container image. </p>\n<h1>Discovering actions in the Github community</h1>\n<p>GitHub Marketplace is a central location for you to find, share, and use actions built by the GitHub community. </p>\n<p>You can also customize your project with open source actions shared in public repositories on GitHub and use actions\nbuilt by GitHub in the actions organization.</p>\n<h1>Use Case</h1>\n<p>Github Actions are in my view very flexible and you can design your workflows in many different ways and when testing it\nout I decided to test two common use cases:</p>\n<ul>\n<li>Run test when you push code to your Github repo master branch.</li>\n<li>Publish new versions of your package to NPM</li>\n</ul>\n<h2>Run test when pushing code to master branch</h2>\n<p>The first test I did was to create an action that should test my code when I push it to the master branch of my Github\nrepository. An action must be created in a directory named .github in your own Github repo as an .yml file.</p>\n<p>The action below is named Node CI, it is triggered on the push event on the master branch, it runs one job called build,\nthe build job uses a matrix strategy - meaning it will build for different versions of Node.js in this case, the build\njob has several steps, check out code, set up a Node.js environment and run npm commands such as ci, install, build and test.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\"># Job name is Node CI\nname: Node CI\n\n# This workflow is triggered on pushes to the master repository.\non:\n  push:\n    branches:\n      - master  # Push events on master branch\n\n# We define our jobs\njobs:\n\n  # Build job\n  build:\n\n    # This job runs on Linux\n    runs-on: ubuntu-latest\n\n    # Runs the jobs for Node.js 12.x and 10.x\n    strategy:\n      matrix:\n        node-version: [12.x, 10.x]\n\n    # Steps for the build job\n    steps:\n\n      # This step check outs code\n      - name: Checkout code\n        uses: actions/checkout@v1\n\n      # This step sets up Node.js according to the strategy chosen\n      - name: Set up Node.js ${{ matrix.node-version }}\n        uses: actions/setup-node@v1\n        with:\n          node-version: ${{ matrix.node-version }}\n\n      # This step runs ci, install packages, build app if available and runs test\n      - name: Run CI, install, build and test\n        run: |\n          npm ci\n          npm install\n          npm run build --if-present\n          npm test\n        env:\n          CI: true</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>This action works perfectly fine every time I pushes code to my master branch in my remote repo located at Github.</p>\n<h2>Publish releases to NPM</h2>\n<p>The second test I did, publish a package to NPM on release, was little trickier since I got some errors indicating access\nfailure to NPM. However, the solution was to log in at NPM, create an access token and in my repo, go to settings and\nadd the NPM token to the repo as a secret. A repo secret is available in Github Actions via ${{secrets.NPM_TOKEN}}</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\"># Job name is Publish to NPM\nname: Publish to NPM\n\n# This workflow is triggered on each release event, the types: [published] \n# is required here since releases could also be updated or deleted, we only \n# want to publish to npm when a new release is created (published).\non:\n  release:\n    types: [published]\n\n# We define our jobs\njobs:\n\n  # Build job\n  build:\n\n    # This job runs on Linux\n    runs-on: ubuntu-latest\n\n    # Steps for the build job\n    steps:\n\n      # This step check outs code\n      - name: Checkout code\n        uses: actions/checkout@v1\n\n      # This step sets up Node.js\n      - name: Set up Node.js\n        uses: actions/setup-node@v1\n        with:\n          node-version: 12\n          registry-url: https://registry.npmjs.org/\n\n      # Install \n      - run: npm install\n\n      # Publish to NPM\n      - run: npm publish --access public\n        env:\n          NODE_AUTH_TOKEN: ${{secrets.NPM_TOKEN}}</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1>Summary</h1>\n<p>I'm surprised how easy it was to use Github Actions and there are also many actions available in the Github Marketplace\nyou can use to build your CI/CD solutions. For example, there are templates to integrate with different cloud providers\nsuch as AWS, Azure, etc.</p>"}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/projects/ci-github-actions/"}}}